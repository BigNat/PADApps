INDEX
=====

HydrauliCAD\___folder_snapshot.py.py
HydrauliCAD\Bridge\bridge.json
HydrauliCAD\Bridge\layer_bridge.json
HydrauliCAD\Bridge\lt_bridge.json
HydrauliCAD\Data\aci_colors.json
HydrauliCAD\Data\current_layer_config.json
HydrauliCAD\Data\current_tool.json
HydrauliCAD\Data\current_tool_config.json
HydrauliCAD\Data\layer_configs\AS.json
HydrauliCAD\Data\layer_configs\Default.json
HydrauliCAD\Data\layer_configs\KOS.json
HydrauliCAD\Data\layer_configs\NDPH.json
HydrauliCAD\Data\response.json
HydrauliCAD\Data\tool_configs\All.json
HydrauliCAD\Data\tool_configs\Design.json
HydrauliCAD\Data\tool_configs\Dev.json
HydrauliCAD\Data\tool_configs\Set Up.json
HydrauliCAD\folder_structure.txt
HydrauliCAD\Lisp\hc_cleanup.lsp
HydrauliCAD\Lisp\hc_cleanup_blocks.lsp
HydrauliCAD\Lisp\hc_cleanup_bylayer.lsp
HydrauliCAD\Lisp\hc_cleanup_dimensions.lsp
HydrauliCAD\Lisp\hc_cleanup_hatching.lsp
HydrauliCAD\Lisp\hc_cleanup_lineweight.lsp
HydrauliCAD\Lisp\hc_cleanup_text.lsp
HydrauliCAD\Lisp\hc_cleanup_ucs.lsp
HydrauliCAD\Lisp\hc_create_layer.lsp
HydrauliCAD\Lisp\hc_designer_commands.lsp
HydrauliCAD\Lisp\hc_get_current_layer.lsp
HydrauliCAD\Lisp\hc_get_layers.lsp
HydrauliCAD\Lisp\hc_json.lsp
HydrauliCAD\Lisp\hc_layer.lsp
HydrauliCAD\Lisp\hc_loader.lsp
HydrauliCAD\Lisp\hc_log.lsp
HydrauliCAD\Lisp\hc_paths.lsp
HydrauliCAD\Lisp\hc_service.lsp
HydrauliCAD\Lisp\hc_test.lsp
HydrauliCAD\Lisp\hc_xref.lsp
HydrauliCAD\Lisp\hc_xref_bridge.lsp
HydrauliCAD\Lisp\Test\doc_events.lsp
HydrauliCAD\Logs\hc_log.txt
HydrauliCAD\Tools\CleanUp\Bridge\batch_bridge.json
HydrauliCAD\Tools\CleanUp\Bridge\default_bridge.json
HydrauliCAD\Tools\CleanUp\Data\clean_up_configs\Batch CleanUp.json
HydrauliCAD\Tools\CleanUp\Data\clean_up_configs\Quick CleanUp.json
HydrauliCAD\Tools\CleanUp\Data\commands.json
HydrauliCAD\Tools\Designer\Bridge\pipe_bridge.json
HydrauliCAD\Tools\Designer\Data\services.json
HydrauliCAD\Tools\Designer\Support\Designer.lin
HydrauliCAD\Tools\LightTable\Bridge\lt_bridge.json
HydrauliCAD\Tools\LightTable\Data\categories.json
HydrauliCAD\Tools\LightTable\Data\Colours\Default.json
HydrauliCAD\Tools\LightTable\Data\Colours\Soft Spectrum.json
HydrauliCAD\Tools\LightTable\Data\layers.json
HydrauliCAD\Tools\LightTable\Data\search.json
RevitPAD\___folder_snapshot.py
RevitPAD\Bridge\revit_command.json
RevitPAD\Bridge\revit_heartbeat.json
RevitPAD\commands\commands.json
RevitPAD\commands\send_export_sheets_to_cad.py
RevitPAD\commands\send_export_sheets_to_json.py
RevitPAD\commands\send_start_watching.py
RevitPAD\commands\send_stop_watching.py
RevitPAD\commands\send_test_command.py
RevitPAD\Core\commands\export_sheets_to_cad.py
RevitPAD\Core\commands\export_sheets_to_pdf.py
RevitPAD\Core\commands\export_views_to_nwc.py
RevitPAD\Core\commands\open_view_by_id.py
RevitPAD\Core\commands\test_command.py
RevitPAD\Core\CommandWatcherHelper.py
RevitPAD\Core\requests\get_3d_views.py
RevitPAD\Core\requests\get_active_view.py
RevitPAD\Core\requests\get_all_views.py
RevitPAD\Core\requests\get_model_path.py
RevitPAD\Core\requests\get_sheet_data.py
RevitPAD\Data\current_tool.json
RevitPAD\Data\current_tool_config.json
RevitPAD\Data\data.json
RevitPAD\Data\response.json
RevitPAD\Data\tool_configs\All.json
RevitPAD\Data\tool_configs\Design.json
RevitPAD\Data\tool_configs\Set Up.json
RevitPAD\folder_structure.txt
RevitPAD\Logs\revit_pad_log.txt
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\commands\export_sheets_to_cad.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\commands\export_sheets_to_json.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\CommandWatcherHelper.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\script.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Export Navisworks.pushbutton\script.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Save Export Settings.pushbutton\script.py
RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Test\Test.pushbutton\script.py
──────────────────────────────────────────────────────────────────────
################################################################################
### HydrauliCAD\___folder_snapshot.py.py
################################################################################
#!/usr/bin/env python3
import os
from pathlib import Path

def build_tree(root: Path) -> list[str]:
    lines = []
    for dirpath, dirnames, filenames in os.walk(root):
        rel = Path(dirpath).relative_to(root)
        if rel == Path("."):
            # Skip the root folder itself
            indent = ""
        else:
            indent = "    " * len(rel.parts)
            lines.append(f"{indent}{rel.name}/")

        subindent = indent + "    "
        for f in sorted(filenames):
            if rel == Path("."):
                # Files directly in root
                lines.append(f"    {f}")
            else:
                lines.append(f"{subindent}{f}")

    return lines


def main():
    root = Path(__file__).resolve().parent
    out_file = root / "folder_structure.txt"

    tree_lines = build_tree(root)
    out_file.write_text("\n".join(tree_lines), encoding="utf-8")

    print(f"✔ Folder snapshot saved to: {out_file}")


if __name__ == "__main__":
    main()

################################################################################
### HydrauliCAD\Bridge\bridge.json
################################################################################
{
  "command": "HC_GETLAYERS"
}

################################################################################
### HydrauliCAD\Bridge\layer_bridge.json
################################################################################
{
  "command": "HC_GETLAYERS"
}

################################################################################
### HydrauliCAD\Bridge\lt_bridge.json
################################################################################
{
  "dwg_path": "C:\\Users\\nweck\\Dropbox\\HydrauliCAD-BT\\Demo\\Design\\AH-SITE.DWG",
  "light_table_xrefs": [
    "LT_XREF_ARCH",
    "LT_XREF_SURVEY",
    "LT_XREF_MISC1",
    "LT_XREF_MISC2"
  ]
}

################################################################################
### HydrauliCAD\Data\aci_colors.json
################################################################################
{
  "1": 255,
  "2": 65535,
  "3": 65280,
  "4": 16776960,
  "5": 16711680,
  "6": 16711935,
  "7": 16777215,
  "8": 8421504,
  "9": 12632256,
  "10": 255,
  "11": 8355839,
  "12": 204,
  "13": 6710988,
  "14": 153,
  "15": 5000345,
  "16": 127,
  "17": 4145023,
  "18": 77,
  "19": 2500172,
  "20": 16383,
  "21": 8364031,
  "22": 13260,
  "23": 6717388,
  "24": 9881,
  "25": 5005209,
  "26": 8063,
  "27": 4149119,
  "28": 4940,
  "29": 2502476,
  "30": 32767,
  "31": 8372223,
  "32": 26316,
  "33": 6724044,
  "34": 19609,
  "35": 5010073,
  "36": 16255,
  "37": 4153215,
  "38": 9804,
  "39": 2505036,
  "40": 49151,
  "41": 8380415,
  "42": 39372,
  "43": 6730444,
  "44": 29337,
  "45": 5014937,
  "46": 24447,
  "47": 4157311,
  "48": 14668,
  "49": 2507340,
  "50": 65535,
  "51": 8388607,
  "52": 52428,
  "53": 6737100,
  "54": 39321,
  "55": 5020057,
  "56": 32639,
  "57": 4161407,
  "58": 19532,
  "59": 2509900,
  "60": 65471,
  "61": 8388575,
  "62": 52377,
  "63": 6737074,
  "64": 39282,
  "65": 5020037,
  "66": 32607,
  "67": 4161391,
  "68": 19513,
  "69": 2509890,
  "70": 65407,
  "71": 8388543,
  "72": 52326,
  "73": 6737049,
  "74": 39244,
  "75": 5020018,
  "76": 32575,
  "77": 4161375,
  "78": 19494,
  "79": 2509881,
  "80": 65343,
  "81": 8388511,
  "82": 52275,
  "83": 6737023,
  "84": 39206,
  "85": 5019999,
  "86": 32543,
  "87": 4161359,
  "88": 19475,
  "89": 2509871,
  "90": 65280,
  "91": 8388479,
  "92": 52224,
  "93": 6736998,
  "94": 39168,
  "95": 5019980,
  "96": 32512,
  "97": 4161343,
  "98": 19456,
  "99": 2509862,
  "100": 4194048,
  "101": 10485631,
  "102": 3394560,
  "103": 8375398,
  "104": 2529536,
  "105": 6265164,
  "106": 2064128,
  "107": 5209919,
  "108": 1264640,
  "109": 3099686,
  "110": 8388352,
  "111": 12582783,
  "112": 6736896,
  "113": 10079334,
  "114": 5019904,
  "115": 7510348,
  "116": 4161280,
  "117": 6258495,
  "118": 2509824,
  "119": 3755046,
  "120": 12582656,
  "121": 14679935,
  "122": 10079232,
  "123": 11717734,
  "124": 7510272,
  "125": 8755532,
  "126": 6258432,
  "127": 7307071,
  "128": 3755008,
  "129": 4344870,
  "130": 16776960,
  "131": 16777087,
  "132": 13421568,
  "133": 13421670,
  "134": 10066176,
  "135": 10066252,
  "136": 8355584,
  "137": 8355647,
  "138": 5000192,
  "139": 5000230,
  "140": 16760576,
  "141": 16768895,
  "142": 13408512,
  "143": 13415014,
  "144": 10056192,
  "145": 10061132,
  "146": 8347392,
  "147": 8351551,
  "148": 4995328,
  "149": 4997670,
  "150": 16744192,
  "151": 16760703,
  "152": 13395456,
  "153": 13408614,
  "154": 10046464,
  "155": 10056268,
  "156": 8339200,
  "157": 8347455,
  "158": 4990464,
  "159": 4995366,
  "160": 16727808,
  "161": 16752511,
  "162": 13382400,
  "163": 13401958,
  "164": 10036736,
  "165": 10051404,
  "166": 8331008,
  "167": 8343359,
  "168": 4985600,
  "169": 4992806,
  "170": 16711680,
  "171": 16744319,
  "172": 13369344,
  "173": 13395558,
  "174": 10027008,
  "175": 10046540,
  "176": 8323072,
  "177": 8339263,
  "178": 4980736,
  "179": 4990502,
  "180": 16711743,
  "181": 16744351,
  "182": 13369395,
  "183": 13395583,
  "184": 10027046,
  "185": 10046559,
  "186": 8323103,
  "187": 8339279,
  "188": 4980755,
  "189": 4990511,
  "190": 16711807,
  "191": 16744383,
  "192": 13369446,
  "193": 13395609,
  "194": 10027084,
  "195": 10046578,
  "196": 8323135,
  "197": 8339295,
  "198": 4980774,
  "199": 4990521,
  "200": 16711871,
  "201": 16744415,
  "202": 13369497,
  "203": 13395634,
  "204": 10027122,
  "205": 10046597,
  "206": 8323167,
  "207": 8339311,
  "208": 4980793,
  "209": 4990530,
  "210": 16711935,
  "211": 16744447,
  "212": 13369548,
  "213": 13395660,
  "214": 10027161,
  "215": 10046617,
  "216": 8323199,
  "217": 8339327,
  "218": 4980812,
  "219": 4990540,
  "220": 12517631,
  "221": 14647295,
  "222": 10027212,
  "223": 11691724,
  "224": 7471257,
  "225": 8735897,
  "226": 6226047,
  "227": 7290751,
  "228": 3735628,
  "229": 4335180,
  "230": 8323327,
  "231": 12550143,
  "232": 6684876,
  "233": 10053324,
  "234": 4980889,
  "235": 7490713,
  "236": 4128895,
  "237": 6242175,
  "238": 2490444,
  "239": 3745356,
  "240": 4129023,
  "241": 10452991,
  "242": 3342540,
  "243": 8349388,
  "244": 2490521,
  "245": 6245529,
  "246": 2031743,
  "247": 5193599,
  "248": 1245260,
  "249": 3089996,
  "250": 3355443,
  "251": 5987163,
  "252": 8684676,
  "253": 11382189,
  "254": 14079702,
  "255": 16777215,
  "256": 16777215,
  "257": 16777215
}

################################################################################
### HydrauliCAD\Data\current_layer_config.json
################################################################################
{
    "current_config": "KOS"
}

################################################################################
### HydrauliCAD\Data\current_tool.json
################################################################################
{
    "current_tool": "DESIGNER"
}

################################################################################
### HydrauliCAD\Data\current_tool_config.json
################################################################################
{
    "current_config": "All"
}

################################################################################
### HydrauliCAD\Data\layer_configs\AS.json
################################################################################
{
  "meta": { "version": "1.1", "description": "HydrauliCAD Designer hydraulic layer configuration (expanded with all pipe, label, and symbol layers)" },
  "layers": [

    { "name": "Hyd_Pipe_Water_CW",  "color": 151, "lineweight": 50, "linetype": "HYD_COLD_WATER" },
    { "name": "Hyd_Pipe_Water_RE",  "color": 83,  "lineweight": 50, "linetype": "HYD_RE_USE" },
    { "name": "Hyd_Pipe_Water_HW",  "color": 22,  "lineweight": 50, "linetype": "HYD_HOT_WATER" },
    { "name": "Hyd_Pipe_Water_HWR", "color": 33,  "lineweight": 50, "linetype": "HYD_HOT_WATER_RETURN" },
    { "name": "Hyd_Pipe_Water_WW",  "color": 41,  "lineweight": 50, "linetype": "HYD_WARM_WATER" },
    { "name": "Hyd_Pipe_Gas_G",     "color": 64,  "lineweight": 50, "linetype": "HYD_GAS" },
    { "name": "Hyd_Pipe_Stormwater_STW", "color": 95,  "lineweight": 70, "linetype": "HYD_STORMWATER" },
    { "name": "Hyd_Pipe_Stormwater_SS",  "color": 125, "lineweight": 70, "linetype": "HYD_SUB_SOIL" },
    { "name": "Hyd_Pipe_Sanitary_SD",    "color": 145, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SP",    "color": 156, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SW",    "color": 167, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_TW",    "color": 177, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_VP",    "color": 199, "lineweight": 70, "linetype": "HYD_VENT" },
    { "name": "Hyd_Pipe_Fire_FH",        "color": 8,   "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FHR",       "color": 11,  "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FS",        "color": 13,  "lineweight": 50, "linetype": "Continuous" },



    { "name": "Hyd_Comment_Info", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Calc", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Note", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_ToDo", "color": 10, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_MLine", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Sound", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Conc", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Heat", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Existing_x", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_x" },
    { "name": "Hyd_Existing_e", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_e" },
    { "name": "Hyd_Existing_w", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_w" },
    { "name": "Hyd_Existing_s", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_s" },
    { "name": "Hyd_Existing_g", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_g" },

    { "name": "Hyd_Label", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Hex", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Rev", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Cloud", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Leader", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Dim", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Detail", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text200", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text250", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text300", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text350", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text500", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text700", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Label_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FH",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FHR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FS",  "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Valve", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FH","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FHR","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FS","color": 7, "lineweight": 25, "linetype": "Continuous" }

  ]
}

################################################################################
### HydrauliCAD\Data\layer_configs\Default.json
################################################################################
{
  "meta": { "version": "1.1", "description": "HydrauliCAD Designer hydraulic layer configuration (expanded with all pipe, label, and symbol layers)" },
  "layers": [

    { "name": "Hyd_Pipe_Water_CW",  "color": 5,   "lineweight": 50, "linetype": "HYD_COLD_WATER" },
    { "name": "Hyd_Pipe_Water_RE",  "color": 192, "lineweight": 50, "linetype": "HYD_RE_USE" },
    { "name": "Hyd_Pipe_Water_HW",  "color": 1,   "lineweight": 50, "linetype": "HYD_HOT_WATER" },
    { "name": "Hyd_Pipe_Water_HWR", "color": 1,   "lineweight": 50, "linetype": "HYD_HOT_WATER_RETURN" },
    { "name": "Hyd_Pipe_Water_WW",  "color": 200, "lineweight": 50, "linetype": "HYD_WARM_WATER" },
    { "name": "Hyd_Pipe_Gas_G",     "color": 3,   "lineweight": 50, "linetype": "HYD_GAS" },
    { "name": "Hyd_Pipe_Stormwater_STW", "color": 30,  "lineweight": 70, "linetype": "HYD_STORMWATER" },
    { "name": "Hyd_Pipe_Stormwater_SS",  "color": 130, "lineweight": 70, "linetype": "HYD_SUB_SOIL" },
    { "name": "Hyd_Pipe_Sanitary_SD",    "color": 80,  "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SP",    "color": 4,   "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SW",    "color": 30,  "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_TW",    "color": 40,  "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_VP",    "color": 240, "lineweight": 70, "linetype": "HYD_VENT" },
    { "name": "Hyd_Pipe_Fire_FH",        "color": 1,   "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FHR",       "color": 5,   "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FS",        "color": 1,   "lineweight": 50, "linetype": "Continuous" },

    { "name": "Hyd_Comment_Info", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Calc", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Note", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_ToDo", "color": 10, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_MLine", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Sound", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Conc", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Heat", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Existing_x", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_x" },
    { "name": "Hyd_Existing_e", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_e" },
    { "name": "Hyd_Existing_w", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_w" },
    { "name": "Hyd_Existing_s", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_s" },
    { "name": "Hyd_Existing_g", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_g" },

    { "name": "Hyd_Label", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Hex", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Rev", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Cloud", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Leader", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Dim", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Detail", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text200", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text250", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text300", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text350", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text500", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text700", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Label_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FH",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FHR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FS",  "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Valve", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FH","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FHR","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FS","color": 7, "lineweight": 25, "linetype": "Continuous" }

  ]
}

################################################################################
### HydrauliCAD\Data\layer_configs\KOS.json
################################################################################
{
  "meta": { "version": "1.1", "description": "HydrauliCAD Designer hydraulic layer configuration (expanded with all pipe, label, and symbol layers)" },
  "layers": [

    { "name": "Hyd_Pipe_Water_CW",  "color": 140, "lineweight": 50, "linetype": "HYD_COLD_WATER" },
    { "name": "Hyd_Pipe_Water_RE",  "color": 90,  "lineweight": 50, "linetype": "HYD_RE_USE" },
    { "name": "Hyd_Pipe_Water_HW",  "color": 10,  "lineweight": 50, "linetype": "HYD_HOT_WATER" },
    { "name": "Hyd_Pipe_Water_HWR", "color": 20,  "lineweight": 50, "linetype": "HYD_HOT_WATER_RETURN" },
    { "name": "Hyd_Pipe_Water_WW",  "color": 40,  "lineweight": 50, "linetype": "HYD_WARM_WATER" },
    { "name": "Hyd_Pipe_Gas_G",     "color": 60,  "lineweight": 50, "linetype": "HYD_GAS" },
    { "name": "Hyd_Pipe_Stormwater_STW", "color": 110, "lineweight": 70, "linetype": "HYD_STORMWATER" },
    { "name": "Hyd_Pipe_Stormwater_SS",  "color": 120, "lineweight": 70, "linetype": "HYD_SUB_SOIL" },
    { "name": "Hyd_Pipe_Sanitary_SD",    "color": 160, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SP",    "color": 170, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SW",    "color": 180, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_TW",    "color": 190, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_VP",    "color": 200, "lineweight": 70, "linetype": "HYD_VENT" },
    { "name": "Hyd_Pipe_Fire_FH",        "color": 220, "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FHR",       "color": 230, "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FS",        "color": 240, "lineweight": 50, "linetype": "Continuous" },


    { "name": "Hyd_Comment_Info", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Calc", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Note", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_ToDo", "color": 10, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_MLine", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Sound", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Conc", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Heat", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Existing_x", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_x" },
    { "name": "Hyd_Existing_e", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_e" },
    { "name": "Hyd_Existing_w", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_w" },
    { "name": "Hyd_Existing_s", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_s" },
    { "name": "Hyd_Existing_g", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_g" },

    { "name": "Hyd_Label", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Hex", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Rev", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Cloud", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Leader", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Dim", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Detail", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text200", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text250", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text300", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text350", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text500", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text700", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Label_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FH",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FHR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FS",  "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Valve", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FH","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FHR","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FS","color": 7, "lineweight": 25, "linetype": "Continuous" }

  ]
}

################################################################################
### HydrauliCAD\Data\layer_configs\NDPH.json
################################################################################
{
  "meta": { "version": "1.1", "description": "HydrauliCAD Designer hydraulic layer configuration (expanded with all pipe, label, and symbol layers)" },
  "layers": [

    { "name": "Hyd_Pipe_Water_CW",  "color": 132, "lineweight": 50, "linetype": "HYD_COLD_WATER" },
    { "name": "Hyd_Pipe_Water_RE",  "color": 93,  "lineweight": 50, "linetype": "HYD_RE_USE" },
    { "name": "Hyd_Pipe_Water_HW",  "color": 21,  "lineweight": 50, "linetype": "HYD_HOT_WATER" },
    { "name": "Hyd_Pipe_Water_HWR", "color": 32,  "lineweight": 50, "linetype": "HYD_HOT_WATER_RETURN" },
    { "name": "Hyd_Pipe_Water_WW",  "color": 44,  "lineweight": 50, "linetype": "HYD_WARM_WATER" },
    { "name": "Hyd_Pipe_Gas_G",     "color": 63,  "lineweight": 50, "linetype": "HYD_GAS" },
    { "name": "Hyd_Pipe_Stormwater_STW", "color": 104, "lineweight": 70, "linetype": "HYD_STORMWATER" },
    { "name": "Hyd_Pipe_Stormwater_SS",  "color": 122, "lineweight": 70, "linetype": "HYD_SUB_SOIL" },
    { "name": "Hyd_Pipe_Sanitary_SD",    "color": 142, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SP",    "color": 154, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_SW",    "color": 165, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_TW",    "color": 176, "lineweight": 70, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Sanitary_VP",    "color": 188, "lineweight": 70, "linetype": "HYD_VENT" },
    { "name": "Hyd_Pipe_Fire_FH",        "color": 9,   "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FHR",       "color": 14,  "lineweight": 50, "linetype": "Continuous" },
    { "name": "Hyd_Pipe_Fire_FS",        "color": 24,  "lineweight": 50, "linetype": "Continuous" },

    { "name": "Hyd_Comment_Info", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Calc", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_Note", "color": 10, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Comment_ToDo", "color": 10, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_MLine", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Sound", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Conc", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Hatch_Heat", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Existing_x", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_x" },
    { "name": "Hyd_Existing_e", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_e" },
    { "name": "Hyd_Existing_w", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_w" },
    { "name": "Hyd_Existing_s", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_s" },
    { "name": "Hyd_Existing_g", "color": 7, "lineweight": 25, "linetype": "Hyd_Existing_g" },

    { "name": "Hyd_Label", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Hex", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Rev", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Cloud", "color": 7, "lineweight": 35, "linetype": "Continuous" },
    { "name": "Hyd_Label_Leader", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Dim", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_General", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Detail", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text200", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text250", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text300", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text350", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text500", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Text700", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Label_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FH",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FHR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Label_Fire_FS",  "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Valve", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_Fixture", "color": 7, "lineweight": 25, "linetype": "Continuous" },

    { "name": "Hyd_Symbol_Water_CW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_RE",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_HWR", "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Water_WW",  "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Gas_G",     "color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_STW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Stormwater_SS","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SD","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_SW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_TW","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Sanitary_VP","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FH","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FHR","color": 7, "lineweight": 25, "linetype": "Continuous" },
    { "name": "Hyd_Symbol_Fire_FS","color": 7, "lineweight": 25, "linetype": "Continuous" }

  ]
}

################################################################################
### HydrauliCAD\Data\response.json
################################################################################
{}

################################################################################
### HydrauliCAD\Data\tool_configs\All.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "HydrauliCAD Tool configuration"
  },
  "tools": [
    "DESIGNER",
    "LIGHT_TABLE",
    "CLEAN_UP",
    "DRAWINGS",
    "INVERTS",
    "LEVELS",
    "PENOS",
    "SETTINGS",
    "TEST"
  ]
}

################################################################################
### HydrauliCAD\Data\tool_configs\Design.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "HydrauliCAD Tool configuration"
  },
  "tools": [
    "DESIGNER",
    "LIGHT_TABLE",
    "INVERTS",
    "LEVELS",
    "SETTINGS"
  ]
}

################################################################################
### HydrauliCAD\Data\tool_configs\Dev.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "HydrauliCAD Tool configuration"
  },
  "tools": [
    "DESIGNER",
    "LIGHT_TABLE",
    "CLEAN_UP",
    "SETTINGS",
    "TEST"
  ]
}

################################################################################
### HydrauliCAD\Data\tool_configs\Set Up.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "HydrauliCAD Tool configuration"
  },
  "tools": [
    "LIGHT_TABLE",
    "CLEAN_UP",
    "DRAWINGS",
    "SETTINGS"
  ]
}

################################################################################
### HydrauliCAD\folder_structure.txt
################################################################################
    HydrauliCAD.arg
    ___folder_snapshot.py.py
    __init__.py
    folder_structure.txt
    Blocks/
    Bridge/
        bridge.json
        lt_bridge.json
    Data/
        __init__.py
        current_layer_config.json
        current_tool.json
        current_tool_config.json
        layer_configs/
            AS.json
            Default.json
            KOS.json
            NDPH.json
            __init__.py
        tool_configs/
            All.json
            Design.json
            Set Up.json
            __init__.py
    Lisp/
        ___snapshot.py
        hc_cleanup.lsp
        hc_cleanup_blocks.lsp
        hc_cleanup_bylayer.lsp
        hc_cleanup_dimensions.lsp
        hc_cleanup_hatching.lsp
        hc_cleanup_lineweight.lsp
        hc_cleanup_text.lsp
        hc_cleanup_ucs.lsp
        hc_designer_commands.lsp
        hc_json.lsp
        hc_layer.lsp
        hc_loader.lsp
        hc_log.lsp
        hc_paths.lsp
        hc_service.lsp
        hc_test.lsp
        hc_xref.lsp
        hc_xref_bridge.lsp
        Test/
            doc_events.lsp
            hc_layer copy.lsp
        _code/
            Lisp_code.txt
    Logs/
        hc_log.txt
    Support/
    Tools/
        Calcs/
            Blocks/
            Data/
            Lisp/
            Support/
        CleanUp/
            Blocks/
            Bridge/
                batch_bridge.json
                default_bridge.json
            Data/
                commands.json
                clean_up_configs/
                    Batch CleanUp.json
                    Quick CleanUp.json
            Lisp/
            Support/
        Designer/
            Blocks/
            Bridge/
                pipe_bridge.json
            Data/
                services.json
            Lisp/
            Support/
                Designer.lin
        DrawingManager/
            Blocks/
            Data/
            Lisp/
            Support/
        InvertLevel/
            Blocks/
            Data/
            Lisp/
            Support/
        Levels/
            Blocks/
            Data/
            Lisp/
            Support/
        LightTable/
            Blocks/
            Bridge/
                lt_bridge.json
            Data/
                categories.json
                layers.json
                search.json
                Colours/
                    Default.json
                    Soft Spectrum.json
            Lisp/
            Support/
        Peno/
            Blocks/
            Data/
            Lisp/
            Support/
        Shared/
            Blocks/
            Data/
            Lisp/
            Support/
        Standards/
            Blocks/
            Data/
            Lisp/
            Support/

################################################################################
### HydrauliCAD\Lisp\hc_cleanup.lsp
################################################################################
;;; =============================================================
;;; HydrauliCAD Cleanup Suite (Pure AutoLISP Implementation)
;;; Modular cleanup command set for batch or toggle use.
;;; =============================================================

;;; Each command is self-contained and independent — no external VBA/Funcs.
;;; All use standard AutoCAD COM calls for portability.


;; -----------------------------
;; hc_cleanup_main.lsp
;; -----------------------------

(setq *hc_cleanup_toggles*
  '(
    ("MakeByLayer" . T)
    ("ChangeLineWeight" . T)
    ("DeleteBlocks" . NIL)
    ("DeleteDimensions" . NIL)
    ("DeleteHatching" . NIL)
    ("DeleteText" . NIL)
    ("DeleteTextMatch" . NIL)
    ("DeleteUCS" . NIL)
  )
)

(defun hc-toggle-cleanup (name)
  (if (assoc name *hc_cleanup_toggles*)
    (progn
      (setq current (cdr (assoc name *hc_cleanup_toggles*)))
      (setq *hc_cleanup_toggles*
        (subst (cons name (not current)) (assoc name *hc_cleanup_toggles*) *hc_cleanup_toggles*)
      )
      (hc-log (strcat "🔘 " name " toggle → " (if (not current) "ON" "OFF")))
    )
  )
)

(defun c:HC_CLEANUP ( / )
  (hc-log "🧹 HydrauliCAD Cleanup started.")
  (foreach toggle *hc_cleanup_toggles*
    (if (cdr toggle)
      (progn
        (setq cmd (strcat "C:HC_" (strcase (car toggle))))
        (if (fboundp (read cmd))
          (progn
            (hc-log (strcat "▶ Running " (car toggle)))
            (eval (read (strcat "(C:HC_" (strcase (car toggle)) ")")))
          )
          (hc-log (strcat "⚠️ Missing cleanup command: " (car toggle)))
        )
      )
    )
  )
  (hc-log "✅ HydrauliCAD Cleanup completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_blocks.lsp
################################################################################


;;; -----------------------------
;;; hc_cleanup_blocks.lsp
;;; -----------------------------
(defun c:HC_DELETEBLOCKS ( / blk ss)
  (setq blk (getstring "Enter block name to delete: "))
  (hc-log (strcat "🧹 DeleteBlocks → " blk))
  (setq ss (ssget "X" (list (cons 0 "INSERT") (cons 2 blk))))
  (if ss
    (repeat (sslength ss)
      (setq e (ssname ss 0))
      (entdel e)
      (ssdel e ss)
    )
  )
  (hc-log "✅ DeleteBlocks completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_bylayer.lsp
################################################################################



;;; -----------------------------
;;; hc_cleanup_bylayer.lsp
;;; -----------------------------
(defun c:HC_MAKEBYLAYER ( / doc ent)
  (hc-log "🧹 MakeByLayer started.")
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))
  (vlax-for ent (vla-get-ModelSpace doc)
    (if (and (not (vlax-property-available-p ent 'IsXRef)) (/= (vla-get-Color ent) 256))
      (vla-put-Color ent 256)
    )
  )
  (hc-log "✅ MakeByLayer completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_dimensions.lsp
################################################################################


;;; -----------------------------
;;; hc_cleanup_dimensions.lsp
;;; -----------------------------
(defun c:HC_DELETEDIMENSIONS ( / ss)
  (hc-log "🧹 DeleteDimensions started.")
  (setq ss (ssget "X" '((0 . "DIMENSION"))))
  (if ss
    (repeat (sslength ss)
      (setq e (ssname ss 0))
      (entdel e)
      (ssdel e ss)
    )
  )
  (hc-log "✅ DeleteDimensions completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_hatching.lsp
################################################################################


;;; -----------------------------
;;; hc_cleanup_hatching.lsp
;;; -----------------------------
(defun c:HC_DELETEHATCHING ( / ss)
  (hc-log "🧹 DeleteHatching started.")
  (setq ss (ssget "X" '((0 . "HATCH"))))
  (if ss
    (repeat (sslength ss)
      (setq e (ssname ss 0))
      (entdel e)
      (ssdel e ss)
    )
  )
  (hc-log "✅ DeleteHatching completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_lineweight.lsp
################################################################################

;;; -----------------------------
;;; hc_cleanup_lineweight.lsp
;;; -----------------------------
(defun c:HC_CHANGELINEWEIGHT ( / doc ent)
  (hc-log "🧹 ChangeLineWeight started.")
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))
  (vlax-for ent (vla-get-ModelSpace doc)
    (vla-put-LineWeight ent acLnWt005)
  )
  (hc-log "✅ ChangeLineWeight completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_text.lsp
################################################################################


;;; -----------------------------
;;; hc_cleanup_text.lsp
;;; -----------------------------
(defun c:HC_DELETETEXT ( / ss)
  (hc-log "🧹 DeleteText started.")
  (setq ss (ssget "X" '((0 . "TEXT"))))
  (if ss
    (progn
      (repeat (sslength ss)
        (setq e (ssname ss 0))
        (entdel e)
        (ssdel e ss)
      )
    )
  )
  (hc-log "✅ DeleteText completed.")
  (princ)
)

(defun c:HC_DELETETEXTMATCH ( / txt ss)
  (setq txt (getstring "Enter text to delete: "))
  (hc-log (strcat "🧹 DeleteTextMatch → " txt))
  (setq ss (ssget "X" (list (cons 0 "TEXT") (cons 1 txt))))
  (if ss
    (repeat (sslength ss)
      (setq e (ssname ss 0))
      (entdel e)
      (ssdel e ss)
    )
  )
  (hc-log "✅ DeleteTextMatch completed.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_cleanup_ucs.lsp
################################################################################


;;; -----------------------------
;;; hc_cleanup_ucs.lsp
;;; -----------------------------
(defun c:HC_DELETEUCS ( / )
  (hc-log "🧹 DeleteUCS started.")
  (command "UCS" "W")
  (command "PLAN" "W")
  (command "UCSFOLLOW" 1)
  (hc-log "✅ DeleteUCS completed.")
  (princ)
)

(princ)

################################################################################
### HydrauliCAD\Lisp\hc_create_layer.lsp
################################################################################
(defun C:HC_CREATE_LAYER ( / )
  (hc-log "🧩 Creating layer...")
  (set_layer_from_bridge)
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_designer_commands.lsp
################################################################################



(defun c:Designer_Pipe ( / )
  (hc-log "🧩 Designer_Pipe command started.")
  (set_layer_from_bridge)
  (hc-log "📏 Drawing pipe line...")
  (command "_.LINE")
  (hc-log "✅ Designer_Pipe command completed.")
  (princ)
)





(defun c:hc_designer_snap (/ a ang)
  (setvar "cmdecho" 0)
  (setvar "orthomode" 1)
  (setq SNAPANG? (getvar "snapang"))
  (setq sang SNAPANG?)
  (cond
    ((= sang 0)
      (setvar "snapang" 0.785398)
      (princ "\nSnap 45° – crosshairs rotated to 45 degrees"))
    ((= sang 0.785398)
      (setvar "snapang" 0)
      (princ "\nSnap 0° – crosshairs rotated to 0 degrees"))
    (t
      (setvar "snapang" 0)
      (princ "\nSnap reset to 0 degrees"))
  )
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_get_current_layer.lsp
################################################################################
(defun C:HC_GETCURRENTLAYER ( / ac doc cur name pybridge )

  (vl-load-com)

  (setq ac   (vlax-get-acad-object))
  (setq doc  (vla-get-ActiveDocument ac))
  (setq cur  (vla-get-ActiveLayer doc))
  (setq name (vla-get-Name cur))

  (setq pybridge (vlax-create-object "HydrauliCAD.JsonBridge"))

  ;; Generic: WriteKeyValue("current_layer", "<name>")
  (vlax-invoke pybridge 'WriteKeyValue "current_layer" name)

  (vlax-release-object pybridge)
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_get_layers.lsp
################################################################################
;;; ---------------------------------------------------------------------------
;;; STEP 1: Raw layer collector
;;; ---------------------------------------------------------------------------
(defun hc_get_layers_raw ( / doc ac
                             names colors ltypes lws locked frozen on
                             name color ltype lw lk fr onflag )

  (setq names   '()
        colors  '()
        ltypes  '()
        lws     '()
        locked  '()
        frozen  '()
        on      '()
  )

  (setq ac  (vlax-get-acad-object))
  (setq doc (vla-get-ActiveDocument ac))

  (vlax-for L (vla-get-Layers doc)

    (setq name  (vla-get-Name L))
    (setq color (vla-get-Color L))
    (setq ltype (vla-get-Linetype L))
    (setq lw    (vla-get-Lineweight L))

    (setq lk     (if (= (vla-get-Lock L) :vlax-true) 1 0))
    (setq fr     (if (= (vla-get-Freeze L) :vlax-true) 1 0))
    (setq onflag (if (= (vla-get-LayerOn L) :vlax-true) 1 0))

    (setq names   (cons name names))
    (setq colors  (cons color colors))
    (setq ltypes  (cons ltype ltypes))
    (setq lws     (cons lw    lws))
    (setq locked  (cons lk     locked))
    (setq frozen  (cons fr     frozen))
    (setq on      (cons onflag on))
  )

  (list
    (reverse names)
    (reverse colors)
    (reverse ltypes)
    (reverse lws)
    (reverse locked)
    (reverse frozen)
    (reverse on)
  )
)


;;; ---------------------------------------------------------------------------
;;; STEP 2: Write layer list to Python bridge (needs DWG_PATH)
;;; ---------------------------------------------------------------------------
(defun hc_write_layer_bridge (dwg_path layer_list / pybridge
                                     names colors ltypes lws locked frozen on)
  (vl-load-com)

  ;; extract the lists safely (only one-level selectors)
  (setq names   (car  layer_list))
  (setq colors  (cadr layer_list))
  (setq ltypes  (caddr layer_list))
  (setq lws     (cadddr layer_list))
  (setq locked  (nth 4 layer_list))
  (setq frozen  (nth 5 layer_list))
  (setq on      (nth 6 layer_list))

  (setq pybridge (vlax-create-object "HydrauliCAD.JsonBridge"))

  ;; call JSON Bridge with seven arguments
  (vlax-invoke pybridge 'BuildLayerList
    dwg_path
    names
    colors
    ltypes
    lws
    locked
    frozen
    on
  )

  (vlax-release-object pybridge)

  (hc-log "✅ hc_write_layer_bridge → layer bridge JSON written successfully.")

  T
)



;;; ---------------------------------------------------------------------------
;;; STEP 3: MAIN COMMAND (must be a real AutoCAD command)
;;; ---------------------------------------------------------------------------
(defun C:HC_GETLAYERS ( / layers ac doc dwg_path )
  (hc-log "📄 HC_GETLAYERS started.")

  (setq ac  (vlax-get-acad-object))
  (setq doc (vla-get-ActiveDocument ac))
  (setq dwg_path (vla-get-FullName doc))

  ;; 1) Collect layers
  (setq layers (hc_get_layers_raw))

  ;; 2) Write bridge with correct DWG path
  (hc_write_layer_bridge dwg_path layers)

  (hc-log "📄 HC_GETLAYERS completed successfully.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_json.lsp
################################################################################
;; ===============================================================
;; hc_json.lsp — HydrauliCAD JSON Read/Write Utility (Generic)
;; ===============================================================

(defun hc-json-get (path key / jsonObj val)
  (setq jsonObj (vlax-create-object "HydrauliCAD.JsonBridge"))
  (setq val (vlax-invoke jsonObj 'GetValue path key))
  (vlax-release-object jsonObj)
  val
)

################################################################################
### HydrauliCAD\Lisp\hc_layer.lsp
################################################################################
(defun hc-create-layer (layer_name color weight line_type / doc layers layer oldColor oldWeight oldType)
  (hc-ensure-linetype-loaded line_type)
  (setq doc (vla-get-ActiveDocument (vlax-get-Acad-Object)))
  (setq layers (vla-get-Layers doc))

  ;; Validate color input
  (if (or (not (numberp color)) (< color 1) (> color 255))
    (setq color 7)
  )

  ;; Create or get the layer
  (if (tblsearch "LAYER" layer_name)
    (progn
      (setq layer (vla-Item layers layer_name))
      (setq oldColor (vla-get-Color layer))
      (setq oldWeight (vla-get-LineWeight layer))
      (setq oldType (vla-get-Linetype layer))

      (hc-log (strcat "🧱 Updating existing layer: " layer_name))
      (hc-log (strcat "   BEFORE → Color:" (itoa oldColor)
                      " | Weight:" (itoa oldWeight)
                      " | Linetype:" oldType))

      ;; Only apply changes if different (and log which change applied)
      (if (/= oldColor color)
        (progn
          (vla-put-Color layer color)
          (hc-log (strcat "   🖌️ Color changed: " (itoa oldColor) " → " (itoa color)))
        )
        (hc-log "   ℹ️ Color already correct.")
      )

      (if (/= oldWeight weight)
        (progn
          (vla-put-LineWeight layer (vlax-make-variant weight))
          (hc-log (strcat "   ⚖️ Lineweight changed: " (itoa oldWeight) " → " (itoa weight)))
        )
        (hc-log "   ℹ️ Lineweight already correct.")
      )

      (if (and oldType (/= (strcase oldType) (strcase line_type)))
        (progn
          (if (tblsearch "LTYPE" line_type)
            (vla-put-Linetype layer line_type)
            (vla-put-Linetype layer "Continuous"))
          (hc-log (strcat "   📏 Linetype changed: " oldType " → " line_type))
        )
        (hc-log "   ℹ️ Linetype already correct.")
      )

      ;; Verify after update
      (hc-log (strcat "✅ AFTER → Color:" (itoa (vla-get-Color layer))
                      " | Weight:" (itoa (vla-get-LineWeight layer))
                      " | Linetype:" (vla-get-Linetype layer)))
    )
    (progn
      (setq layer (vla-Add layers layer_name))
      (vla-put-Color layer color)
      (vla-put-LineWeight layer (vlax-make-variant weight))
      (if (tblsearch "LTYPE" line_type)
        (vla-put-Linetype layer line_type)
        (vla-put-Linetype layer "Continuous"))
      (hc-log (strcat "🎨 Created new layer: " layer_name
                      "  [Color: " (itoa color)
                      " | Weight: " (itoa weight)
                      " | Linetype: " (if (tblsearch "LTYPE" line_type) line_type "Continuous")
                      "]"))
    )
  )

  ;; Refresh to display changes
  (vla-Regen doc acAllViewports)
)







(defun hc-ensure-linetype-loaded (line_type / doc)
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))
  (if (not (tblsearch "LTYPE" line_type))
    (progn
      (command "_.-linetype" "_load" line_type "C:\\PADApps\\HydrauliCAD\\Tools\\Designer\\Support\\Designer.lin" "")
      (hc-log (strcat "📏 Linetype loaded → " line_type))
    )
    (hc-log (strcat "ℹ️ Linetype already available: " line_type))
  )
)



(defun set_layer_from_bridge ( / jsonfile layer_name line_type color weight)
  (setq jsonfile (hc-get-designer-bridge-json-path))
  (setq layer_name (hc-json-get jsonfile "layer"))
  (setq line_type (hc-json-get jsonfile "linetype"))
  (setq color (atoi (hc-json-get jsonfile "color")))
  (setq weight (atoi (hc-json-get jsonfile "weight")))

  (if (not layer_name) (setq layer_name "Hyd_Pipe_Default"))
  (if (not line_type) (setq line_type "Continuous"))
  (if (not color) (setq color 7))
  (if (not weight) (setq weight 25))

  (hc-create-layer layer_name color weight line_type)

  (setvar "clayer" layer_name)
  (hc-log (strcat "✅ Current layer set → " layer_name))
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_loader.lsp
################################################################################
;;; ---------------------------------------------------------------
;;; hc_loader.lsp – Auto-loader for HydrauliCAD (with logging order)
;;; ---------------------------------------------------------------
(vl-load-com)
(load "hc_paths.lsp")

(defun c:hc_loader ( / hc_path files full)
  (setq hc_path (hc-get-lisp-path))

  (if (not (vl-file-directory-p hc_path))
    (progn
      (princ (strcat "\n⚠️ HydrauliCAD folder not found: " hc_path))
      (exit)
    )
  )

  ;; ------------------------------------------------------------
  ;; 1️⃣ Always load logger first (safe dependency)
  ;; ------------------------------------------------------------
  (setq full (strcat hc_path "hc_paths.lsp"))
  (if (findfile full)
    (progn
      (load full)
    )
    (princ "\n⚠️ Paths file not found — hc_paths.lsp missing")
  )
  
  (setq full (strcat hc_path "hc_log.lsp"))
  (if (findfile full)
    (progn
      (load full)
      (princ "\n✅ Loaded hc_log.lsp (logger initialized)")
      (hc-log-init)
      (hc-log "🚀 Starting HydrauliCAD Loader...")
    )
    (princ "\n⚠️ Logger not found — hc_log.lsp missing")
  )

  ;; ------------------------------------------------------------
  ;; 2️⃣ Load all other .lsp files except this loader and logger
  ;; ------------------------------------------------------------
  (setq files
        (vl-remove-if
          '(lambda (x) (member x '("hc_loader.lsp" "hc_log.lsp" "hc_paths.lsp")))
          (vl-directory-files hc_path "*.lsp" 1)
        )
  )

  (foreach f files
    (setq full (strcat hc_path f))
    (if (findfile full)
      (progn
        (load full)
        (hc-log (strcat "✅ Loaded " f))
      )
      (hc-log (strcat "⚠️ Missing " full))
    )
  )

  (hc-log "✅ HydrauliCAD startup complete.")
  (princ "\nHydrauliCAD startup complete.")
  (princ)
)

;;; ------------------------------------------------------------
;;; Run only once per AutoCAD session
;;; ------------------------------------------------------------
(if (not (boundp '*hc_loader_initialized*))
  (progn
    (setq *hc_loader_initialized* T)
    (c:hc_loader)
  )
)
(princ)

################################################################################
### HydrauliCAD\Lisp\hc_log.lsp
################################################################################
;; ===============================================================
;; hc_log.lsp — HydrauliCAD Logging Utility (Session-Aware)
;; ===============================================================

(defun hc-log-init ( / file session-line)
  (setq file (hc-get-logs-file))
  (setq session-line
        (strcat
          "\n============================================================\n"
          "🕓 New HydrauliCAD Session: "
          (menucmd "M=$(edtime,$(getvar,date),YYYY-MM-DD HH:MM:SS)")
          "\n============================================================"))
  (setq f (open file "a"))
  (if f (progn (write-line session-line f) (close f)))
  (princ "\n🪵 Log session started.")
)

(defun hc-log-clear ( / file)
  (setq file (hc-get-logs-file))
  (if (findfile file)
    (progn
      (setq f (open file "w"))
      (write-line "🧹 Cleared previous HydrauliCAD log." f)
      (close f)
      (princ "\n🧹 Log file cleared."))
  )
)

(defun hc-log (msg / f tstamp line file)
  (setq file (hc-get-logs-file))
  (setq tstamp (menucmd "M=$(edtime,$(getvar,date),YYYY-MM-DD HH:MM:SS)"))
  (setq line (strcat "[" tstamp "] " msg))
  (setq f (open file "a"))
  (if f (progn (write-line line f) (close f)))
  (princ (strcat "\n🪵 " line))
)
(princ)

################################################################################
### HydrauliCAD\Lisp\hc_paths.lsp
################################################################################
;; ===============================================================
;; hc_paths.lsp — HydrauliCAD Path Utilities 
;; ===============================================================

;; ---------------------------------------------------------------
;; Get HydrauliCAD root installation path 

(defun hc-get-root-path ( / path )
  (setq path "C:/PADApps/HydrauliCAD/")
  path
)

;; ---------------------------------------------------------------
;; Get HydrauliCAD data path
(defun hc-get-data-path ( / path )
  (setq path (strcat (hc-get-root-path) "Data/"))
  path
)

;; ---------------------------------------------------------------
;; Get HydrauliCAD lisp path
(defun hc-get-lisp-path ( / path )
  (setq path (strcat (hc-get-root-path) "Lisp/"))
  path
)
;; ---------------------------------------------------------------

;; Get HydrauliCAD Blocks path
(defun hc-get-blocks-path ( / path )
  (setq path (strcat (hc-get-root-path) "Blocks/"))
  path
)
;; ---------------------------------------------------------------

;; Get HydrauliCAD Support path
(defun hc-get-support-path ( / path )
  (setq path (strcat (hc-get-root-path) "Support/"))
  path
)
;; ---------------------------------------------------------------

;; Get HydrauliCAD Logs path
(defun hc-get-logs-path ( / path )
  (setq path (strcat (hc-get-root-path) "Logs/"))
  path
)

(defun hc-get-logs-file ( / path )
  (setq path (strcat (hc-get-logs-path) "hc_log.txt"))
  path
)

;; ---------------------------------------------------------------


(defun hc-get-service-json-path ()
  (strcat (hc-get-data-path) "services.json")
)

(defun hc-get-layer-json-path ()
  (strcat (hc-get-data-path) "layers.json")
)


(defun hc-get-bridge-json-path ()
  (strcat (hc-get-root-path) "Bridge/bridge.json")
)


(defun hc-get-designer-bridge-json-path ()
  (strcat (hc-get-root-path) "Tools/Designer/Bridge/pipe_bridge.json")
)


(defun hc-get-layer-config ()
  (strcat (hc-get-root-path) "Bridge/layer_config.json")
)




(princ)

################################################################################
### HydrauliCAD\Lisp\hc_service.lsp
################################################################################


################################################################################
### HydrauliCAD\Lisp\hc_test.lsp
################################################################################


(defun c:t1 ( / jsonfile txt layer_name service desc)
  (setq jsonfile (hc-get-bridge-json-path))
  (setq txt (hc-json-read jsonfile))
  
  (hc-log "📦 Bridge data loaded.")
  (hc-log (strcat "📄 JSON preview: " (substr txt 1 1000)))

  (setq layer_name (hc-parse-json-value txt "layer"))
  (setq line_type (hc-parse-json-value txt "linetype"))
  (setq color (atoi (hc-parse-json-value txt "color")))
  (setq weight (atoi (hc-parse-json-value txt "weight")))
  (setq plot/ (vlax-make-variant T))
  
  (setq service (hc-parse-json-value txt "service"))
  (setq desc (hc-parse-json-value txt "description"))

  (hc-log (strcat "💧 Service → " service " (" desc ")"))
  (hc-log (strcat "🧱 Target layer → " layer_name))
  (hc-log (strcat "🎨 Layer properties → Color: " (itoa color)
                  " | Weight: " (itoa weight)
                  " | Linetype: " line_type
                  " | Plot: " (if plot/ "Yes" "No")))
  (hc-log "✅ Test completed successfully.")
  (princ)
)


(defun c:t2 ( / value )
  (setq value (hc-json-get (hc-get-bridge-json-path) "color"))
  (princ (strcat "\nColor: " value))
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\hc_xref.lsp
################################################################################
(defun hc_get_xrefs ( / doc blk result name )
  (vl-load-com)
  (setq result '())
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))

  (hc-log "🔍 hc_get_xrefs → scanning drawing for XREFs...")

  (vlax-for blk (vla-get-Blocks doc)
    (if (and (vlax-property-available-p blk 'IsXRef)
             (= (vla-get-IsXRef blk) :vlax-true))
      (progn
        (setq name (vla-get-Name blk))
        (setq result (cons name result))
        (hc-log (strcat "   🔗 Found XREF: " name))
      )
    )
  )

  (setq result (reverse result))
  (hc-log (strcat "📊 hc_get_xrefs → total XREFs found: " (itoa (length result))))
  result
)



(defun hc_get_xref_details ( / doc blk result entry val_safe val_name val_load val_resolve val_path )
  (vl-load-com)
  (setq result '())
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))

  ;; Safe property getter with error handling and logging
  (defun val_safe (obj prop)
    (setq val (vl-catch-all-apply '(lambda () (vlax-get-property obj prop))))
    (if (vl-catch-all-error-p val)
      (progn
        (hc-log (strcat "      ⚠️ Property access failed: " (vl-princ-to-string prop)))
        nil
      )
      (progn
        (hc-log (strcat "      ✅ " (vl-princ-to-string prop) " = " (vl-princ-to-string val)))
        val
      )
    )
  )

  (hc-log "🔍 hc_get_xref_details → scanning blocks for Light Table XREFs...")

  (vlax-for blk (vla-get-Blocks doc)
    (if (and (vlax-property-available-p blk 'IsXRef)
             (= (vla-get-IsXRef blk) :vlax-true))
      (progn
        (setq val_name (vla-get-Name blk))
        (hc-log (strcat "   🔹 Processing XREF: " val_name))
        (setq val_path    (val_safe blk 'Path))

        (setq entry
          (list
            (cons "name" val_name)
            (cons "path" (if val_path val_path ""))
          )
        )

        (setq result (cons entry result))
        (hc-log (strcat "   💡 Captured XREF entry: " val_name))
      )
    )
  )

  (setq result (reverse result))
  (hc-log (strcat "📊 hc_get_xref_details → total Light Table XREFs captured: " (itoa (length result))))
  result
)



(defun hc_convert_xref_data (xref_list / jsonlist item)
  (setq jsonlist '())
  (foreach item xref_list
    ;; Convert assoc list → JSON-like list of pairs: [key, value]
    (setq jsonlist
      (cons
        (list
          (cdr (assoc "name" item))
          (cdr (assoc "path" item))
        )
        jsonlist
      )
    )
  )
  (reverse jsonlist)
)

################################################################################
### HydrauliCAD\Lisp\hc_xref_bridge.lsp
################################################################################


(defun hc_filter_xrefs (xrefs / filtered)
  (setq filtered '())
  (foreach name xrefs
    (if (wcmatch (strcase name) "LT_XREF_*")
      (setq filtered (cons name filtered))
    )
  )
  (setq filtered (reverse filtered))
  (hc-log (strcat "🔍 hc_filter_xrefs → " (itoa (length filtered)) " Light Table XREF(s) found."))
  filtered
)


(defun hc_write_bridge (dwgpath xref_data / names paths pybridge)
  (vl-load-com)
  (foreach x xref_data
    (setq names (cons (cdr (assoc "name" x)) names))
    (setq paths (cons (cdr (assoc "path" x)) paths))
  )
  (setq names (reverse names))
  (setq paths (reverse paths))

  (setq pybridge (vlax-create-object "HydrauliCAD.JsonBridge"))
  (vlax-invoke pybridge 'BuildLightTableData dwgpath names paths)
  (vlax-release-object pybridge)
  (hc-log "✅ hc_write_bridge → bridge written successfully.")
)






(defun c:hc_write_xref_data ( / doc dwgpath xrefs lt_xrefs )
  (vl-load-com)
  (setq doc (vla-get-ActiveDocument (vlax-get-acad-object)))
  (setq dwgpath (vla-get-FullName doc))

  (hc-log "📦 hc_write_xref_data started.")
  
  (setq xrefs (hc_get_xrefs))
  (setq xref_data (hc_get_xref_details))
  
  (hc_write_bridge dwgpath xref_data)
  
  (hc-log "📄 hc_write_xref_data completed successfully.")
  (princ)
)

################################################################################
### HydrauliCAD\Lisp\Test\doc_events.lsp
################################################################################
;; ===============================================================
;; doc_timer.lsp — HydrauliCAD Open Drawing Tracker (Universal Timer)
;; ===============================================================

(vl-load-com)

;; ---------------------------------------------------------------
;; Utility: Write to HydrauliCAD log
;; ---------------------------------------------------------------
(defun hyd-log (msg / f tstamp line file)
  (setq file "C:/HydrauliCAD/Data/hydraulicad_log.txt")
  (setq tstamp (menucmd "M=$(edtime,$(getvar,date),YYYY-MM-DD HH:MM:SS)"))
  (setq line (strcat "[" tstamp "] " msg))
  (setq f (open file "a"))
  (if f (progn (write-line line f) (close f)))
  (princ (strcat "\n🪵 " line))
)

;; ---------------------------------------------------------------
;; Utility: Collect and write JSON
;; ---------------------------------------------------------------
(defun hyd-write-open-json ( / file drawlist current f jsontext app docs )
  (setq file "C:/HydrauliCAD/Data/open_drawings.json")
  (setq app (vlax-get-acad-object))
  (setq docs (vla-get-Documents app))
  (setq drawlist '())
  (vlax-for d docs
    (setq drawlist (cons (vla-get-FullName d) drawlist))
  )
  (setq drawlist (reverse drawlist))
  (setq current (strcat (getvar "DWGPREFIX") (getvar "DWGNAME")))

  ;; Build JSON
  (setq jsontext "{\n  \"current\": \"")
  (setq jsontext (strcat jsontext (vl-string-translate "\\" "/" current) "\",\n"))
  (setq jsontext (strcat jsontext "  \"open\": [\n"))
  (foreach dwg drawlist
    (if (/= dwg "")
      (setq jsontext (strcat jsontext "    \"" (vl-string-translate "\\" "/" dwg) "\",\n"))
    )
  )
  (if (> (strlen jsontext) 6)
    (setq jsontext (substr jsontext 1 (- (strlen jsontext) 2)))
  )
  (setq jsontext (strcat jsontext "\n  ]\n}\n"))

  (setq f (open file "w"))
  (if f (progn (write-line jsontext f) (close f)))
  (hyd-log (strcat "📘 Updated open_drawings.json (" (itoa (length drawlist)) " drawings)"))
)

;; ---------------------------------------------------------------
;; Heartbeat function
;; ---------------------------------------------------------------
(defun hyd-heartbeat-loop ( / delay )
  (setq delay 2000) ;; 2 seconds
  (while *HydHeartbeatActive*
    (vl-catch-all-apply 'hyd-write-open-json)
    (command "_delay" delay)
  )
)

;; ---------------------------------------------------------------
;; Commands
;; ---------------------------------------------------------------
(defun c:HYD_TIMER_START ( / )
  (if (not *HydHeartbeatActive*)
    (progn
      (setq *HydHeartbeatActive* T)
      (hyd-log "▶ Starting HydrauliCAD timer loop (2 sec)...")
      (hyd-write-open-json)
      (hyd-heartbeat-loop)
    )
    (hyd-log "⚠ Timer already running.")
  )
  (princ)
)

(defun c:HYD_TIMER_STOP ( / )
  (if *HydHeartbeatActive*
    (progn
      (setq *HydHeartbeatActive* nil)
      (hyd-log "⏹ HydrauliCAD timer stopped.")
    )
    (hyd-log "⚠ Timer not active.")
  )
  (princ)
)

;; ---------------------------------------------------------------
;; Load message
;; ---------------------------------------------------------------
(hyd-log "🔄 HydrauliCAD simple timer tracker loaded.")
(princ "\nType HYD_TIMER_START to begin 2-second tracking, HYD_TIMER_STOP to end.")
(princ)

################################################################################
### HydrauliCAD\Logs\hc_log.txt
################################################################################

============================================================
\U+D83D\U+DD53 New HydrauliCAD Session: 2025-09-01 16:09:27
============================================================
[2025-09-01 16:09:27] 🚀 Starting HydrauliCAD Loader...
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_blocks.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_hatching.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_text.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_cleanup_ucs.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_designer_commands.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_get_current_layer.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_get_layers.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_json.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_layer.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_service.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_test.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_xref.lsp
[2025-09-01 16:09:27] ✅ Loaded hc_xref_bridge.lsp
[2025-09-01 16:09:27] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-09-01 16:09:40
============================================================
[2025-09-01 16:09:40] 🚀 Starting HydrauliCAD Loader...
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_blocks.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_hatching.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_text.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_cleanup_ucs.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_designer_commands.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_get_current_layer.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_get_layers.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_json.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_layer.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_service.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_test.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_xref.lsp
[2025-09-01 16:09:40] ✅ Loaded hc_xref_bridge.lsp
[2025-09-01 16:09:40] ✅ HydrauliCAD startup complete.
[2025-20-01 16:20:32] 📄 HC_GETLAYERS started.
[2025-20-01 16:20:32] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-20-01 16:20:32] 📄 HC_GETLAYERS completed successfully.
[2025-36-01 16:36:54] 📄 HC_GETLAYERS started.
[2025-36-01 16:36:54] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-36-01 16:36:54] 📄 HC_GETLAYERS completed successfully.
[2025-40-01 16:40:11] 🧩 Designer_Pipe command started.
[2025-40-01 16:40:11] 📏 Linetype loaded → HYD_COLD_WATER
[2025-40-01 16:40:11] 🎨 Created new layer: Hyd_Pipe_Water_CW  [Color: 140 | Weight: 50 | Linetype: HYD_COLD_WATER]
[2025-40-01 16:40:11] ✅ Current layer set → Hyd_Pipe_Water_CW
[2025-40-01 16:40:11] 📏 Drawing pipe line...
[2025-40-01 16:40:11] ✅ Designer_Pipe command completed.
[2025-41-01 16:41:22] 📄 HC_GETLAYERS started.
[2025-41-01 16:41:22] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-41-01 16:41:22] 📄 HC_GETLAYERS completed successfully.
[2025-41-01 16:41:24] 🧩 Creating layer...
[2025-41-01 16:41:24] 📏 Linetype loaded → HYD_RE_USE
[2025-41-01 16:41:24] 🎨 Created new layer: Hyd_Pipe_Water_RE  [Color: 90 | Weight: 50 | Linetype: HYD_RE_USE]
[2025-41-01 16:41:24] ✅ Current layer set → Hyd_Pipe_Water_RE
[2025-42-01 16:42:47] 📄 HC_GETLAYERS started.
[2025-42-01 16:42:47] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-42-01 16:42:47] 📄 HC_GETLAYERS completed successfully.
[2025-42-01 16:42:48] 🧩 Creating layer...
[2025-42-01 16:42:48] 📏 Linetype loaded → HYD_HOT_WATER
[2025-42-01 16:42:48] 🎨 Created new layer: Hyd_Pipe_Water_HW  [Color: 10 | Weight: 50 | Linetype: HYD_HOT_WATER]
[2025-42-01 16:42:48] ✅ Current layer set → Hyd_Pipe_Water_HW
[2025-43-01 16:43:04] 📄 HC_GETLAYERS started.
[2025-43-01 16:43:04] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-43-01 16:43:04] 📄 HC_GETLAYERS completed successfully.
[2025-43-01 16:43:04] 🧩 Creating layer...
[2025-43-01 16:43:04] 📏 Linetype loaded → HYD_HOT_WATER_RETURN
[2025-43-01 16:43:04] 🎨 Created new layer: Hyd_Pipe_Water_HWR  [Color: 20 | Weight: 50 | Linetype: HYD_HOT_WATER_RETURN]
[2025-43-01 16:43:04] ✅ Current layer set → Hyd_Pipe_Water_HWR
[2025-02-01 17:02:35] 🧩 Designer_Pipe command started.
[2025-02-01 17:02:35] ℹ️ Linetype already available: HYD_COLD_WATER
[2025-02-01 17:02:35] 🧱 Updating existing layer: Hyd_Pipe_Water_CW
[2025-02-01 17:02:36]    BEFORE → Color:140 | Weight:50 | Linetype:HYD_COLD_WATER
[2025-02-01 17:02:36]    ℹ️ Color already correct.
[2025-02-01 17:02:36]    ℹ️ Lineweight already correct.
[2025-02-01 17:02:36]    ℹ️ Linetype already correct.
[2025-02-01 17:02:36] ✅ AFTER → Color:140 | Weight:50 | Linetype:HYD_COLD_WATER
[2025-02-01 17:02:36] ✅ Current layer set → Hyd_Pipe_Water_CW
[2025-02-01 17:02:36] 📏 Drawing pipe line...
[2025-02-01 17:02:36] ✅ Designer_Pipe command completed.
[2025-02-01 17:02:41] 🧩 Designer_Pipe command started.
[2025-02-01 17:02:41] ℹ️ Linetype already available: HYD_RE_USE
[2025-02-01 17:02:41] 🧱 Updating existing layer: Hyd_Pipe_Water_RE
[2025-02-01 17:02:41]    BEFORE → Color:90 | Weight:50 | Linetype:HYD_RE_USE
[2025-02-01 17:02:41]    ℹ️ Color already correct.
[2025-02-01 17:02:41]    ℹ️ Lineweight already correct.
[2025-02-01 17:02:41]    ℹ️ Linetype already correct.
[2025-02-01 17:02:41] ✅ AFTER → Color:90 | Weight:50 | Linetype:HYD_RE_USE
[2025-02-01 17:02:41] ✅ Current layer set → Hyd_Pipe_Water_RE
[2025-02-01 17:02:41] 📏 Drawing pipe line...
[2025-02-01 17:02:41] ✅ Designer_Pipe command completed.
[2025-02-01 17:02:43] 🧩 Designer_Pipe command started.
[2025-02-01 17:02:43] ℹ️ Linetype already available: HYD_HOT_WATER
[2025-02-01 17:02:43] 🧱 Updating existing layer: Hyd_Pipe_Water_HW
[2025-02-01 17:02:43]    BEFORE → Color:10 | Weight:50 | Linetype:HYD_HOT_WATER
[2025-02-01 17:02:43]    ℹ️ Color already correct.
[2025-02-01 17:02:43]    ℹ️ Lineweight already correct.
[2025-02-01 17:02:43]    ℹ️ Linetype already correct.
[2025-02-01 17:02:43] ✅ AFTER → Color:10 | Weight:50 | Linetype:HYD_HOT_WATER
[2025-02-01 17:02:43] ✅ Current layer set → Hyd_Pipe_Water_HW
[2025-02-01 17:02:43] 📏 Drawing pipe line...
[2025-02-01 17:02:43] ✅ Designer_Pipe command completed.
[2025-48-01 17:48:46] 📄 HC_GETLAYERS started.
[2025-48-01 17:48:46] ✅ hc_write_layer_bridge → layer bridge JSON written successfully.
[2025-48-01 17:48:46] 📄 HC_GETLAYERS completed successfully.
[2025-48-01 17:48:52] 🧩 Designer_Pipe command started.
[2025-48-01 17:48:52] ℹ️ Linetype already available: HYD_COLD_WATER
[2025-48-01 17:48:52] 🧱 Updating existing layer: Hyd_Pipe_Water_CW
[2025-48-01 17:48:52]    BEFORE → Color:140 | Weight:50 | Linetype:HYD_COLD_WATER
[2025-48-01 17:48:52]    ℹ️ Color already correct.
[2025-48-01 17:48:52]    ℹ️ Lineweight already correct.
[2025-48-01 17:48:52]    ℹ️ Linetype already correct.
[2025-48-01 17:48:52] ✅ AFTER → Color:140 | Weight:50 | Linetype:HYD_COLD_WATER
[2025-48-01 17:48:52] ✅ Current layer set → Hyd_Pipe_Water_CW
[2025-48-01 17:48:52] 📏 Drawing pipe line...
[2025-48-01 17:48:52] ✅ Designer_Pipe command completed.

============================================================
🕓 New HydrauliCAD Session: 2025-11-02 17:11:46
============================================================
[2025-11-02 17:11:46] 🚀 Starting HydrauliCAD Loader...
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_blocks.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_hatching.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_text.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_cleanup_ucs.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_create_layer.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_designer_commands.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_get_current_layer.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_get_layers.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_json.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_layer.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_service.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_test.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_xref.lsp
[2025-11-02 17:11:46] ✅ Loaded hc_xref_bridge.lsp
[2025-11-02 17:11:46] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-11-02 17:11:55
============================================================
[2025-11-02 17:11:55] 🚀 Starting HydrauliCAD Loader...
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_blocks.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_hatching.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_text.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_cleanup_ucs.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_create_layer.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_designer_commands.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_get_current_layer.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_get_layers.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_json.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_layer.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_service.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_test.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_xref.lsp
[2025-11-02 17:11:55] ✅ Loaded hc_xref_bridge.lsp
[2025-11-02 17:11:55] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-12-02 17:12:10
============================================================
[2025-12-02 17:12:10] 🚀 Starting HydrauliCAD Loader...
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_blocks.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_hatching.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_text.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_cleanup_ucs.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_create_layer.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_designer_commands.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_get_current_layer.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_get_layers.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_json.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_layer.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_service.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_test.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_xref.lsp
[2025-12-02 17:12:10] ✅ Loaded hc_xref_bridge.lsp
[2025-12-02 17:12:10] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-12-02 17:12:15
============================================================
[2025-12-02 17:12:15] 🚀 Starting HydrauliCAD Loader...
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_blocks.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_hatching.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_text.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_cleanup_ucs.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_create_layer.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_designer_commands.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_get_current_layer.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_get_layers.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_json.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_layer.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_service.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_test.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_xref.lsp
[2025-12-02 17:12:15] ✅ Loaded hc_xref_bridge.lsp
[2025-12-02 17:12:15] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-12-02 17:12:19
============================================================
[2025-12-02 17:12:19] 🚀 Starting HydrauliCAD Loader...
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_blocks.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_hatching.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_text.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_cleanup_ucs.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_create_layer.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_designer_commands.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_get_current_layer.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_get_layers.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_json.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_layer.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_service.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_test.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_xref.lsp
[2025-12-02 17:12:19] ✅ Loaded hc_xref_bridge.lsp
[2025-12-02 17:12:19] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-19-02 19:19:53
============================================================
[2025-19-02 19:19:53] 🚀 Starting HydrauliCAD Loader...
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_blocks.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_hatching.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_text.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_cleanup_ucs.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_create_layer.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_designer_commands.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_get_current_layer.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_get_layers.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_json.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_layer.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_service.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_test.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_xref.lsp
[2025-19-02 19:19:53] ✅ Loaded hc_xref_bridge.lsp
[2025-19-02 19:19:53] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-27-02 19:27:24
============================================================
[2025-27-02 19:27:24] 🚀 Starting HydrauliCAD Loader...
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_blocks.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_hatching.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_text.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_cleanup_ucs.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_create_layer.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_designer_commands.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_get_current_layer.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_get_layers.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_json.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_layer.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_service.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_test.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_xref.lsp
[2025-27-02 19:27:24] ✅ Loaded hc_xref_bridge.lsp
[2025-27-02 19:27:24] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-35-02 22:35:11
============================================================
[2025-35-02 22:35:11] 🚀 Starting HydrauliCAD Loader...
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_blocks.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_hatching.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_text.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_cleanup_ucs.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_create_layer.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_designer_commands.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_get_current_layer.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_get_layers.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_json.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_layer.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_service.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_test.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_xref.lsp
[2025-35-02 22:35:11] ✅ Loaded hc_xref_bridge.lsp
[2025-35-02 22:35:11] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-35-02 22:35:28
============================================================
[2025-35-02 22:35:28] 🚀 Starting HydrauliCAD Loader...
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_blocks.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_hatching.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_text.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_cleanup_ucs.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_create_layer.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_designer_commands.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_get_current_layer.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_get_layers.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_json.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_layer.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_service.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_test.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_xref.lsp
[2025-35-02 22:35:28] ✅ Loaded hc_xref_bridge.lsp
[2025-35-02 22:35:28] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-34-02 23:34:13
============================================================
[2025-34-02 23:34:13] 🚀 Starting HydrauliCAD Loader...
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_blocks.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_hatching.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_text.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_cleanup_ucs.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_create_layer.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_designer_commands.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_get_current_layer.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_get_layers.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_json.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_layer.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_service.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_test.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_xref.lsp
[2025-34-02 23:34:13] ✅ Loaded hc_xref_bridge.lsp
[2025-34-02 23:34:13] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-34-02 23:34:21
============================================================
[2025-34-02 23:34:21] 🚀 Starting HydrauliCAD Loader...
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_blocks.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_hatching.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_text.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_cleanup_ucs.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_create_layer.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_designer_commands.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_get_current_layer.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_get_layers.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_json.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_layer.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_service.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_test.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_xref.lsp
[2025-34-02 23:34:21] ✅ Loaded hc_xref_bridge.lsp
[2025-34-02 23:34:21] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-34-02 23:34:25
============================================================
[2025-34-02 23:34:25] 🚀 Starting HydrauliCAD Loader...
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_blocks.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_hatching.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_text.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_cleanup_ucs.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_create_layer.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_designer_commands.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_get_current_layer.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_get_layers.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_json.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_layer.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_service.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_test.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_xref.lsp
[2025-34-02 23:34:25] ✅ Loaded hc_xref_bridge.lsp
[2025-34-02 23:34:25] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-34-02 23:34:40
============================================================
[2025-34-02 23:34:40] 🚀 Starting HydrauliCAD Loader...
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_blocks.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_hatching.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_text.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_cleanup_ucs.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_create_layer.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_designer_commands.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_get_current_layer.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_get_layers.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_json.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_layer.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_service.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_test.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_xref.lsp
[2025-34-02 23:34:40] ✅ Loaded hc_xref_bridge.lsp
[2025-34-02 23:34:40] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-34-02 23:34:55
============================================================
[2025-34-02 23:34:55] 🚀 Starting HydrauliCAD Loader...
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_blocks.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_hatching.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_text.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_cleanup_ucs.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_create_layer.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_designer_commands.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_get_current_layer.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_get_layers.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_json.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_layer.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_service.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_test.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_xref.lsp
[2025-34-02 23:34:55] ✅ Loaded hc_xref_bridge.lsp
[2025-34-02 23:34:55] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:08
============================================================
[2025-40-02 23:40:08] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:08] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:08] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:12
============================================================
[2025-40-02 23:40:12] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:12] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:12] ✅ HydrauliCAD startup complete.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:19
============================================================
[2025-40-02 23:40:19] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:19] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:19] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:19] 🧹 MakeByLayer started.
[2025-40-02 23:40:19] ✅ MakeByLayer completed.
[2025-40-02 23:40:21] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:21] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:21] 🧹 DeleteDimensions started.
[2025-40-02 23:40:21] ✅ DeleteDimensions completed.
[2025-40-02 23:40:21] 🧹 DeleteHatching started.
[2025-40-02 23:40:21] ✅ DeleteHatching completed.
[2025-40-02 23:40:21] 🧹 DeleteUCS started.
[2025-40-02 23:40:21] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:23
============================================================
[2025-40-02 23:40:23] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:23] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:23] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:24] 🧹 MakeByLayer started.
[2025-40-02 23:40:24] ✅ MakeByLayer completed.
[2025-40-02 23:40:24] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:24] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:24] 🧹 DeleteDimensions started.
[2025-40-02 23:40:24] ✅ DeleteDimensions completed.
[2025-40-02 23:40:26] 🧹 DeleteHatching started.
[2025-40-02 23:40:26] ✅ DeleteHatching completed.
[2025-40-02 23:40:26] 🧹 DeleteUCS started.
[2025-40-02 23:40:26] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:28
============================================================
[2025-40-02 23:40:28] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:28] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:28] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:29] 🧹 MakeByLayer started.
[2025-40-02 23:40:29] ✅ MakeByLayer completed.
[2025-40-02 23:40:29] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:29] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:29] 🧹 DeleteDimensions started.
[2025-40-02 23:40:29] ✅ DeleteDimensions completed.
[2025-40-02 23:40:29] 🧹 DeleteHatching started.
[2025-40-02 23:40:29] ✅ DeleteHatching completed.
[2025-40-02 23:40:29] 🧹 DeleteUCS started.
[2025-40-02 23:40:29] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:31
============================================================
[2025-40-02 23:40:31] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:31] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:31] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:33] 🧹 MakeByLayer started.
[2025-40-02 23:40:33] ✅ MakeByLayer completed.
[2025-40-02 23:40:34] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:34] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:34] 🧹 DeleteDimensions started.
[2025-40-02 23:40:34] ✅ DeleteDimensions completed.
[2025-40-02 23:40:34] 🧹 DeleteHatching started.
[2025-40-02 23:40:34] ✅ DeleteHatching completed.
[2025-40-02 23:40:35] 🧹 DeleteUCS started.
[2025-40-02 23:40:35] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:36
============================================================
[2025-40-02 23:40:36] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:36] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:36] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:36] 🧹 MakeByLayer started.
[2025-40-02 23:40:36] ✅ MakeByLayer completed.
[2025-40-02 23:40:38] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:38] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:38] 🧹 DeleteDimensions started.
[2025-40-02 23:40:38] ✅ DeleteDimensions completed.
[2025-40-02 23:40:38] 🧹 DeleteHatching started.
[2025-40-02 23:40:38] ✅ DeleteHatching completed.
[2025-40-02 23:40:38] 🧹 DeleteUCS started.
[2025-40-02 23:40:38] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:40
============================================================
[2025-40-02 23:40:40] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:40] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:40] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:41] 🧹 MakeByLayer started.
[2025-40-02 23:40:41] ✅ MakeByLayer completed.
[2025-40-02 23:40:41] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:41] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:41] 🧹 DeleteDimensions started.
[2025-40-02 23:40:41] ✅ DeleteDimensions completed.
[2025-40-02 23:40:41] 🧹 DeleteHatching started.
[2025-40-02 23:40:41] ✅ DeleteHatching completed.
[2025-40-02 23:40:41] 🧹 DeleteUCS started.
[2025-40-02 23:40:41] ✅ DeleteUCS completed.

============================================================
🕓 New HydrauliCAD Session: 2025-40-02 23:40:43
============================================================
[2025-40-02 23:40:43] 🚀 Starting HydrauliCAD Loader...
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_blocks.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_bylayer.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_dimensions.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_hatching.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_lineweight.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_text.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_cleanup_ucs.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_create_layer.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_designer_commands.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_get_current_layer.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_get_layers.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_json.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_layer.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_service.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_test.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_xref.lsp
[2025-40-02 23:40:43] ✅ Loaded hc_xref_bridge.lsp
[2025-40-02 23:40:43] ✅ HydrauliCAD startup complete.
[2025-40-02 23:40:45] 🧹 MakeByLayer started.
[2025-40-02 23:40:45] ✅ MakeByLayer completed.
[2025-40-02 23:40:45] 🧹 ChangeLineWeight started.
[2025-40-02 23:40:45] ✅ ChangeLineWeight completed.
[2025-40-02 23:40:46] 🧹 DeleteDimensions started.
[2025-40-02 23:40:46] ✅ DeleteDimensions completed.
[2025-40-02 23:40:46] 🧹 DeleteHatching started.
[2025-40-02 23:40:46] ✅ DeleteHatching completed.
[2025-40-02 23:40:46] 🧹 DeleteUCS started.
[2025-40-02 23:40:46] ✅ DeleteUCS completed.
[2025-41-02 23:41:45] 🧹 MakeByLayer started.
[2025-41-02 23:41:45] ✅ MakeByLayer completed.
[2025-41-02 23:41:47] 🧹 MakeByLayer started.
[2025-41-02 23:41:47] ✅ MakeByLayer completed.
[2025-41-02 23:41:50] 🧹 MakeByLayer started.
[2025-41-02 23:41:50] ✅ MakeByLayer completed.
[2025-41-02 23:41:50] 🧹 ChangeLineWeight started.
[2025-41-02 23:41:52] ✅ ChangeLineWeight completed.
[2025-41-02 23:41:52] 🧹 DeleteDimensions started.
[2025-41-02 23:41:52] ✅ DeleteDimensions completed.
[2025-41-02 23:41:52] 🧹 DeleteHatching started.
[2025-41-02 23:41:52] ✅ DeleteHatching completed.
[2025-41-02 23:41:52] 🧹 DeleteUCS started.
[2025-41-02 23:41:52] ✅ DeleteUCS completed.
[2025-42-02 23:42:17] 🧹 ChangeLineWeight started.
[2025-42-02 23:42:17] ✅ ChangeLineWeight completed.
[2025-42-02 23:42:33] 🧹 MakeByLayer started.
[2025-42-02 23:42:33] ✅ MakeByLayer completed.
[2025-43-02 23:43:01] 🧩 Designer_Pipe command started.
[2025-43-02 23:43:01] 📏 Linetype loaded → HYD_COLD_WATER
[2025-43-02 23:43:01] 🎨 Created new layer: Hyd_Pipe_Water_CW  [Color: 140 | Weight: 50 | Linetype: HYD_COLD_WATER]
[2025-43-02 23:43:01] ✅ Current layer set → Hyd_Pipe_Water_CW
[2025-43-02 23:43:01] 📏 Drawing pipe line...
[2025-43-02 23:43:01] ✅ Designer_Pipe command completed.

################################################################################
### HydrauliCAD\Tools\CleanUp\Bridge\batch_bridge.json
################################################################################
{
  "layer": "Hyd_Pipe_Water_CW",
  "service": "CW",
  "description": "\ud83d\udca7 CW - Cold Water",
  "color": 5,
  "weight": 50,
  "linetype": "HYD_COLD_WATER"
}

################################################################################
### HydrauliCAD\Tools\CleanUp\Bridge\default_bridge.json
################################################################################
{
  "layer": "Hyd_Pipe_Water_CW",
  "service": "CW",
  "description": "\ud83d\udca7 CW - Cold Water",
  "color": 5,
  "weight": 50,
  "linetype": "HYD_COLD_WATER"
}

################################################################################
### HydrauliCAD\Tools\CleanUp\Data\clean_up_configs\Batch CleanUp.json
################################################################################
{
  "make_bylayer": true,
  "change_lineweight": true,
  "delete_text": false,
  "delete_text_match": false,
  "delete_blocks": false,
  "delete_dimensions": true,
  "delete_hatching": true,
  "delete_ucs": true
}

################################################################################
### HydrauliCAD\Tools\CleanUp\Data\clean_up_configs\Quick CleanUp.json
################################################################################
{
  "make_bylayer": true,
  "change_lineweight": true,
  "delete_text": false,
  "delete_text_match": false,
  "delete_blocks": false,
  "delete_dimensions": true,
  "delete_hatching": true,
  "delete_ucs": true
}

################################################################################
### HydrauliCAD\Tools\CleanUp\Data\commands.json
################################################################################
{
  "commands": {
    "make_bylayer": "HC_MAKEBYLAYER",
    "change_lineweight": "HC_CHANGELINEWEIGHT",
    "delete_text": "HC_DELETETEXT",
    "delete_text_match": "HC_DELETETEXTMATCH",
    "delete_blocks": "HC_DELETEBLOCKS",
    "delete_dimensions": "HC_DELETEDIMENSIONS",
    "delete_hatching": "HC_DELETEHATCHING",
    "delete_ucs": "HC_DELETEUCS"
  }
}

################################################################################
### HydrauliCAD\Tools\Designer\Bridge\pipe_bridge.json
################################################################################
{
  "layer": "Hyd_Pipe_Water_CW",
  "service": "CW",
  "description": "Cold Water",
  "color": 140,
  "weight": 50,
  "linetype": "HYD_COLD_WATER"
}

################################################################################
### HydrauliCAD\Tools\Designer\Data\services.json
################################################################################
{
  "meta": { "version": "1.0", "description": "HydrauliCAD service definitions" },
  "services": [
    {"emoji": "💧", "abbr": "CW", "input": "C", "name": "Cold Water", "system": "Water", "block_size": 150 },
    {"emoji": "🌱", "abbr": "RE", "input": "RE", "name": "Re-use", "system": "Water", "block_size": 150 },
    {"emoji": "♨️", "abbr": "HW", "input": "H", "name": "Hot Water", "system": "Water", "block_size": 150 },
    {"emoji": "♾️", "abbr": "HWR", "input": "R", "name": "Hot Water Return", "system": "Water", "block_size": 150 },
    {"emoji": "🚿", "abbr": "WW", "input": "WW", "name": "Warm Water", "system": "Water", "block_size": 150 },
    {"emoji": "⚡", "abbr": "G", "input": "G", "name": "Gas", "system": "Gas", "block_size": 150 },
    {"emoji": "🌧️", "abbr": "STW", "input": "S", "name": "Stormwater", "system": "Stormwater", "block_size": 200 },
    {"emoji": "🧭", "abbr": "SS", "input": "SS", "name": "Sub-soil", "system": "Stormwater", "block_size": 200 },
    {"emoji": "🏗️", "abbr": "SD", "input": "D", "name": "Drainage", "system": "Sanitary", "block_size": 200 },
    {"emoji": "🛣️", "abbr": "SP", "input": "P", "name": "Plumbing", "system": "Sanitary", "block_size": 200 },
    {"emoji": "🏛️", "abbr": "TW", "input": "T", "name": "Trade Waste", "system": "Sanitary", "block_size": 200 },
    {"emoji": "📌", "abbr": "VP", "input": "V", "name": "Vent", "system": "Sanitary", "block_size": 200 },
    {"emoji": "🧯", "abbr": "FH", "input": "F", "name": "Fire Hydrant", "system": "Fire", "block_size": 150 },
    {"emoji": "🌀", "abbr": "FHR", "input": "O", "name": "Fire Hose Reel", "system": "Fire", "block_size": 150 },
    {"emoji": "🔥", "abbr": "FS", "input": "FS", "name": "Fire Sprinkler", "system": "Fire", "block_size": 150 }
  ]
}

################################################################################
### HydrauliCAD\Tools\Designer\Support\Designer.lin
################################################################################

*HYD_COLD_WATER,__________  .  __________
A,1.5,-0.25
*HYD_RE_USE,---------
A,0.9,-0.15,0.25,-0.15
*HYD_FLUSH,---------
A,2.0,-0.11,["FL",standard,s=0.20,r=0,x=0,y=-.055],-0.2
*HYD_HOT_WATER,__________  ..  __________
A,0.9,-0.15,0,-0.15,0,-0.15
*HYD_HOT_WATER_RETURN,__________  ...  __________
A,0.9,-0.15,0,-0.15,0,-0.15,0,-0.15
*HYD_WARM_WATER,---------
A,0.9,-0.15,0,-0.15,0.25,-0.15,0,-0.15
*HYD_GAS,---------
A,0.9,-0.15,0.25,-0.15,0.25,-0.15
*HYD_STORMWATER,---------
A,1.5,-0.25
*HYD_VENT,---------
A,1.5,-0.25
*HYD_SUB_SOIL,---------
A,1.2,-0.05,["/",Hyd_Pipe,s=.3,r=5,x=0,y=-0.15],-0.2,1.2
*HYD_EXISTING, ----- e ----- e -----
A,2.0,-0.11,["e",Hyd_Pipe,s=0.20,r=0,x=0,y=-.055],-0.2
*HYD_EX_SEWER, ----- s ----- s -----
A,2.0,-0.11,["s",Hyd_Pipe,s=0.20,r=0,x=0,y=-.055],-0.2
*HYD_EX_WATER, ----- w ----- w -----
A,2.0,-0.11,["w",Hyd_Pipe,s=0.20,r=0,x=0,y=-.055],-0.2
*HYD_EX_GAS, ----- g ----- g -----
A,2.0,-0.11,["g",Hyd_Pipe,s=0.20,r=0,x=0,y=-.055],-0.2




;;
;;  AutoCAD Linetype Definition file
;;  Version 3.0
;;  Copyright (C) 1991-2006 by Autodesk, Inc.  All Rights Reserved.
;;
;;  Note: in order to ease migration of this file when upgrading 
;;  to a future version of AutoCAD, it is recommended that you add
;;  your customizations to the User Defined Linetypes section at the
;;  end of this file.
;;
*BORDER,Border __ __ . __ __ . __ __ . __ __ . __ __ .
A,.5,-.25,.5,-.25,0,-.25
*BORDER2,Border (.5x) __.__.__.__.__.__.__.__.__.__.__.
A,.25,-.125,.25,-.125,0,-.125
*BORDERX2,Border (2x) ____  ____  .  ____  ____  .  ___
A,1.0,-.5,1.0,-.5,0,-.5

*CENTER,Center ____ _ ____ _ ____ _ ____ _ ____ _ ____
A,1.25,-.25,.25,-.25
*CENTER2,Center (.5x) ___ _ ___ _ ___ _ ___ _ ___ _ ___
A,.75,-.125,.125,-.125
*CENTERX2,Center (2x) ________  __  ________  __  ______
A,2.5,-.5,.5,-.5

*DASHDOT,Dash dot __ . __ . __ . __ . __ . __ . __ . __
A,.5,-.25,0,-.25
*DASHDOT2,Dash dot (.5x) _._._._._._._._._._._._._._._.
A,.25,-.125,0,-.125
*DASHDOTX2,Dash dot (2x) ____  .  ____  .  ____  .  ___
A,1.0,-.5,0,-.5

*DASHED,Dashed __ __ __ __ __ __ __ __ __ __ __ __ __ _
A,.5,-.25
*DASHED2,Dashed (.5x) _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
A,.25,-.125
*DASHEDX2,Dashed (2x) ____  ____  ____  ____  ____  ___
A,1.0,-.5

*DIVIDE,Divide ____ . . ____ . . ____ . . ____ . . ____
A,.5,-.25,0,-.25,0,-.25
*DIVIDE2,Divide (.5x) __..__..__..__..__..__..__..__.._
A,.25,-.125,0,-.125,0,-.125
*DIVIDEX2,Divide (2x) ________  .  .  ________  .  .  _
A,1.0,-.5,0,-.5,0,-.5

*DOT,Dot . . . . . . . . . . . . . . . . . . . . . . . .
A,0,-.25
*DOT2,Dot (.5x) ........................................
A,0,-.125
*DOTX2,Dot (2x) .  .  .  .  .  .  .  .  .  .  .  .  .  .
A,0,-.5

*HIDDEN,Hidden __ __ __ __ __ __ __ __ __ __ __ __ __ __
A,.25,-.125
*HIDDEN2,Hidden (.5x) _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
A,.125,-.0625
*HIDDENX2,Hidden (2x) ____ ____ ____ ____ ____ ____ ____ 
A,.5,-.25

*PHANTOM,Phantom ______  __  __  ______  __  __  ______ 
A,1.25,-.25,.25,-.25,.25,-.25
*PHANTOM2,Phantom (.5x) ___ _ _ ___ _ _ ___ _ _ ___ _ _
A,.625,-.125,.125,-.125,.125,-.125
*PHANTOMX2,Phantom (2x) ____________    ____    ____   _
A,2.5,-.5,.5,-.5,.5,-.5

;;
;;  ISO 128 (ISO/DIS 12011) linetypes
;;
;;  The size of the line segments for each defined ISO line, is 
;;  defined for an usage with a pen width of 1 mm. To use them with 
;;  the other ISO predefined pen widths, the line has to be scaled 
;;  with the appropriate value (e.g. pen width 0,5 mm -> ltscale 0.5).
;;
*ACAD_ISO02W100,ISO dash __ __ __ __ __ __ __ __ __ __ __ __ __
A,12,-3
*ACAD_ISO03W100,ISO dash space __    __    __    __    __    __
A,12,-18
*ACAD_ISO04W100,ISO long-dash dot ____ . ____ . ____ . ____ . _
A,24,-3,0,-3
*ACAD_ISO05W100,ISO long-dash double-dot ____ .. ____ .. ____ . 
A,24,-3,0,-3,0,-3
*ACAD_ISO06W100,ISO long-dash triple-dot ____ ... ____ ... ____
A,24,-3,0,-3,0,-3,0,-3
*ACAD_ISO07W100,ISO dot . . . . . . . . . . . . . . . . . . . . 
A,0,-3
*ACAD_ISO08W100,ISO long-dash short-dash ____ __ ____ __ ____ _
A,24,-3,6,-3
*ACAD_ISO09W100,ISO long-dash double-short-dash ____ __ __ ____
A,24,-3,6,-3,6,-3
*ACAD_ISO10W100,ISO dash dot __ . __ . __ . __ . __ . __ . __ . 
A,12,-3,0,-3
*ACAD_ISO11W100,ISO double-dash dot __ __ . __ __ . __ __ . __ _
A,12,-3,12,-3,0,-3
*ACAD_ISO12W100,ISO dash double-dot __ . . __ . . __ . . __ . . 
A,12,-3,0,-3,0,-3
*ACAD_ISO13W100,ISO double-dash double-dot __ __ . . __ __ . . _
A,12,-3,12,-3,0,-3,0,-3
*ACAD_ISO14W100,ISO dash triple-dot __ . . . __ . . . __ . . . _
A,12,-3,0,-3,0,-3,0,-3
*ACAD_ISO15W100,ISO double-dash triple-dot __ __ . . . __ __ . .
A,12,-3,12,-3,0,-3,0,-3,0,-3

;;  Complex linetypes
;;
;;  Complex linetypes have been added to this file.
;;  These linetypes were defined in LTYPESHP.LIN in
;;  Release 13, and are incorporated in ACAD.LIN in
;;  Release 14.
;;  
;;  These linetype definitions use LTYPESHP.SHX.
;;
*FENCELINE1,Fenceline circle ----0-----0----0-----0----0-----0--
A,.25,-.1,[CIRC1,ltypeshp.shx,x=-.1,s=.1],-.1,1
*FENCELINE2,Fenceline square ----[]-----[]----[]-----[]----[]---
A,.25,-.1,[BOX,ltypeshp.shx,x=-.1,s=.1],-.1,1
*TRACKS,Tracks -|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-
A,.15,[TRACK1,ltypeshp.shx,s=.25],.15
*BATTING,Batting SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
A,.0001,-.1,[BAT,ltypeshp.shx,x=-.1,s=.1],-.2,[BAT,ltypeshp.shx,r=180,x=.1,s=.1],-.1
*HOT_WATER_SUPPLY,Hot water supply ---- HW ---- HW ---- HW ----
A,.5,-.2,["HW",STANDARD,S=.1,R=0.0,X=-0.1,Y=-.05],-.2
*GAS_LINE,Gas line ----GAS----GAS----GAS----GAS----GAS----GAS--
A,.5,-.2,["GAS",STANDARD,S=.1,R=0.0,X=-0.1,Y=-.05],-.25
*ZIGZAG,Zig zag /\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/
A,.0001,-.2,[ZIG,ltypeshp.shx,x=-.2,s=.2],-.4,[ZIG,ltypeshp.shx,r=180,x=.2,s=.2],-.2

;;  User Defined Linetypes
;;
;;  Add any linetypes that you define to this section of
;;  the file to ensure that they migrate properly when
;;  upgrading to a future AutoCAD version.  If duplicate
;;  linetype definitions are found in this file, items
;;  in the User Defined Linetypes section take precedence
;;  over definitions that appear earlier in the file.
;;

################################################################################
### HydrauliCAD\Tools\LightTable\Bridge\lt_bridge.json
################################################################################
{
  "dwg_path": "C:/Users/nweck/Dropbox/HydrauliCAD-BT/Demo/Design/AH-SITE.DWG",
  "xref_count": 5,
  "xrefs": [
    {
      "name": "LT_XREF_ARCH",
      "path": "H:\\25031 - Johnny Lee House - FREE\\3. Project Outputs\\2.1 Drawings\\XA-SITE.DWG"
    },
    {
      "name": "LT_XREF_SURVEY",
      "path": "H:\\25031 - Johnny Lee House - FREE\\3. Project Outputs\\2.1 Drawings\\XSURVEY.DWG"
    },
    {
      "name": "LT_XREF_MISC1",
      "path": "H:\\25031 - Johnny Lee House - FREE\\3. Project Outputs\\2.1 Drawings\\XA-GND.DWG"
    },
    {
      "name": "LT_XREF_MISC2",
      "path": "H:\\25031 - Johnny Lee House - FREE\\3. Project Outputs\\2.1 Drawings\\XA-CARPORT.DWG"
    },
    {
      "name": "XZ-Titleblock_A1",
      "path": "H:\\25031 - Johnny Lee House - FREE\\3. Project Outputs\\2.1 Drawings\\XZ-Titleblock_A1.dwg"
    }
  ],
  "summary": "5 XREFs found and documented."
}

################################################################################
### HydrauliCAD\Tools\LightTable\Data\categories.json
################################################################################
{
  "light_table_categories": [
    { "service": "GRID",          "category": "Reference" },
    { "service": "ARCH",          "category": "Architecture" },
    { "service": "STRUCT",        "category": "Structure" },
    { "service": "UPPER_ARCH",    "category": "Architecture" },
    { "service": "LOWER_ARCH",    "category": "Architecture" },
    { "service": "UPPER_SERVICE", "category": "Services" },
    { "service": "LOWER_SERVICE", "category": "Services" },
    { "service": "ELECT",         "category": "Services" },
    { "service": "FIRE",          "category": "Services" },
    { "service": "HYD",           "category": "Services" },
    { "service": "MECH",          "category": "Services" },
    { "service": "CEILING",       "category": "Architecture" },
    { "service": "SURVEY",        "category": "Reference" },
    { "service": "PENO",          "category": "Coordination" },
    { "service": "MISC1",         "category": "Misc" },
    { "service": "MISC2",         "category": "Misc" },
    { "service": "MISC3",         "category": "Misc" }
  ]
}

################################################################################
### HydrauliCAD\Tools\LightTable\Data\Colours\Default.json
################################################################################
{
  "light_table_colours": [
    { "service": "GRID",          "color": 191 },
    { "service": "ARCH",          "color": 8 },
    { "service": "STRUCT",        "color": 41 },
    { "service": "UPPER_ARCH",    "color": 142 },
    { "service": "LOWER_ARCH",    "color": 81 },
    { "service": "UPPER_SERVICE", "color": 4 },
    { "service": "LOWER_SERVICE", "color": 3 },
    { "service": "ELECT",         "color": 142 },
    { "service": "FIRE",          "color": 230 },
    { "service": "HYD",           "color": 141 },
    { "service": "MECH",          "color": 22 },
    { "service": "CEILING",       "color": 54 },
    { "service": "SURVEY",        "color": 9 },
    { "service": "PENO",          "color": 211 },
    { "service": "MISC1",         "color": 8 },
    { "service": "MISC2",         "color": 56 },
    { "service": "MISC3",         "color": 43 }
  ]
}

################################################################################
### HydrauliCAD\Tools\LightTable\Data\Colours\Soft Spectrum.json
################################################################################
{
  "light_table_colours": [
    { "service": "GRID",          "color": 253 },
    { "service": "ARCH",          "color": 30 },
    { "service": "STRUCT",        "color": 100 },
    { "service": "UPPER_ARCH",    "color": 93 },
    { "service": "LOWER_ARCH",    "color": 82 },
    { "service": "UPPER_SERVICE", "color": 174 },
    { "service": "LOWER_SERVICE", "color": 171 },
    { "service": "ELECT",         "color": 92 },
    { "service": "FIRE",          "color": 14 },
    { "service": "HYD",           "color": 132 },
    { "service": "MECH",          "color": 11 },
    { "service": "CEILING",       "color": 91 },
    { "service": "SURVEY",        "color": 21 },
    { "service": "PENO",          "color": 222 },
    { "service": "MISC1",         "color": 8 },
    { "service": "MISC2",         "color": 132 },
    { "service": "MISC3",         "color": 253 }
  ]
}

################################################################################
### HydrauliCAD\Tools\LightTable\Data\layers.json
################################################################################
{
  "light_table_layers": [
    { "service": "GRID",          "layer": "LT_XREF_GRID" },
    { "service": "ARCH",          "layer": "LT_XREF_ARCH" },
    { "service": "STRUCT",        "layer": "LT_XREF_STRUCT" },
    { "service": "UPPER_ARCH",    "layer": "LT_XREF_UPPER_ARCH" },
    { "service": "LOWER_ARCH",    "layer": "LT_XREF_LOWER_ARCH" },
    { "service": "UPPER_SERVICE", "layer": "LT_XREF_UPPER_SERVICE" },
    { "service": "LOWER_SERVICE", "layer": "LT_XREF_LOWER_SERVICE" },
    { "service": "ELECT",         "layer": "LT_XREF_ELECT" },
    { "service": "FIRE",          "layer": "LT_XREF_FIRE" },
    { "service": "HYD",           "layer": "LT_XREF_HYD" },
    { "service": "MECH",          "layer": "LT_XREF_MECH" },
    { "service": "CEILING",       "layer": "LT_XREF_CEILING" },
    { "service": "SURVEY",        "layer": "LT_XREF_SURVEY" },
    { "service": "PENO",          "layer": "LT_XREF_PENO" },
    { "service": "MISC1",         "layer": "LT_XREF_MISC1" },
    { "service": "MISC2",         "layer": "LT_XREF_MISC2" },
    { "service": "MISC3",         "layer": "LT_XREF_MISC3" }
  ]
}

################################################################################
### HydrauliCAD\Tools\LightTable\Data\search.json
################################################################################
{
  "search_terms": [
    { "service": "GRID",          "search_term": "xg*.dwg" },
    { "service": "ARCH",          "search_term": "xa-*.dwg" },
    { "service": "STRUCT",        "search_term": "xs-*.dwg" },
    { "service": "UPPER_ARCH",    "search_term": "xa-*.dwg" },
    { "service": "LOWER_ARCH",    "search_term": "xa-*.dwg" },
    { "service": "UPPER_SERVICE", "search_term": "ah-*.dwg" },
    { "service": "LOWER_SERVICE", "search_term": "ah-*.dwg" },
    { "service": "ELECT",         "search_term": "xe-*.dwg" },
    { "service": "FIRE",          "search_term": "xf-*.dwg" },
    { "service": "HYD",           "search_term": "xh-*.dwg" },
    { "service": "MECH",          "search_term": "xm-*.dwg" },
    { "service": "CEILING",       "search_term": "xac*.dwg" },
    { "service": "SURVEY",        "search_term": "xsur.dwg" },
    { "service": "PENO",          "search_term": "ap.dwg" },
    { "service": "MISC1",         "search_term": "*.dwg" },
    { "service": "MISC2",         "search_term": "*.dwg" },
    { "service": "MISC3",         "search_term": "*.dwg" }
  ]
}

################################################################################
### RevitPAD\___folder_snapshot.py
################################################################################
#!/usr/bin/env python3
import os
from pathlib import Path

def build_tree(root: Path) -> list[str]:
    lines = []
    for dirpath, dirnames, filenames in os.walk(root):
        rel = Path(dirpath).relative_to(root)
        if rel == Path("."):
            # Skip the root folder itself
            indent = ""
        else:
            indent = "    " * len(rel.parts)
            lines.append(f"{indent}{rel.name}/")

        subindent = indent + "    "
        for f in sorted(filenames):
            if rel == Path("."):
                # Files directly in root
                lines.append(f"    {f}")
            else:
                lines.append(f"{subindent}{f}")

    return lines


def main():
    root = Path(__file__).resolve().parent
    out_file = root / "folder_structure.txt"

    tree_lines = build_tree(root)
    out_file.write_text("\n".join(tree_lines), encoding="utf-8")

    print(f"✔ Folder snapshot saved to: {out_file}")


if __name__ == "__main__":
    main()

################################################################################
### RevitPAD\Bridge\revit_command.json
################################################################################
{}

################################################################################
### RevitPAD\Bridge\revit_heartbeat.json
################################################################################
{"status": "alive", "timestamp": 1764679578.3931122}

################################################################################
### RevitPAD\commands\commands.json
################################################################################
{
    "commands": [
        {
            "command": "export_sheets_to_json"
        },
        {
            "command": "test_command"
        },
        {
            "command": "start_watching"
        },
        {
            "command": "stop_watching"
        },
        {
            "command": "export_sheets_to_cad",
            "sheet_ids": [
                359502,
                842837
            ],
            "cad_format": "dwg",
            "path": "C:\\PADApps\\RevitPAD\\Exports"
        }
    ]
}

################################################################################
### RevitPAD\commands\send_export_sheets_to_cad.py
################################################################################
import json
import time

WATCH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"

data = {
    "command": "export_sheets_to_cad",
    "sheet_ids": [359502, 842837],
    "cad_format": "dwg",
    "path": r"C:\PADApps\RevitPAD\Exports"
}

with open(WATCH, "w") as f:
    json.dump(data, f, indent=2)

print("Sent command: export_sheets_to_cad")
time.sleep(0.2)

################################################################################
### RevitPAD\commands\send_export_sheets_to_json.py
################################################################################
import json
import time

WATCH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"

data = {
    "command": "export_sheets_to_json"
}

with open(WATCH, "w") as f:
    json.dump(data, f, indent=2)

print("Sent command: export_sheets_to_json")
time.sleep(0.2)

################################################################################
### RevitPAD\commands\send_start_watching.py
################################################################################
import json
import time

WATCH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"

data = {
    "command": "start_watching"
}

with open(WATCH, "w") as f:
    json.dump(data, f, indent=2)

print("Sent command: start_watching")
time.sleep(0.2)

################################################################################
### RevitPAD\commands\send_stop_watching.py
################################################################################
import json
import time

WATCH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"

data = {
    "command": "test_command"
}

with open(WATCH, "w") as f:
    json.dump(data, f, indent=2)

print("Sent command: test_command")
time.sleep(0.2)

################################################################################
### RevitPAD\commands\send_test_command.py
################################################################################
import json
import time

WATCH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"

data = {
    "command": "test_command"
}

with open(WATCH, "w") as f:
    json.dump(data, f, indent=2)

print("Sent command: test_command")
time.sleep(0.2)

################################################################################
### RevitPAD\Core\commands\export_sheets_to_cad.py
################################################################################
# -*- coding: utf-8 -*-
import os, json, clr
from pyrevit import forms
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    BuiltInCategory,
    ViewSheet,
    DWGExportOptions,
    DXFExportOptions,
    ElementId
)

# Add System.Collections.Generic for List[ElementId]
clr.AddReference("System")
from System.Collections.Generic import List

# --------------------------------------------------------------------------
# RESPONSE PATH
# --------------------------------------------------------------------------
REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def write_response(payload, log):
    """Write response.json for DWG export (success or error)."""
    try:
        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)
        with open(RESPONSE_PATH, "w") as f:
            json.dump(payload, f, indent=2)
        log("DWG response.json written.")
    except Exception as e:
        log("ERROR writing DWG response.json: {}".format(e))


# --------------------------------------------------------------------------
# MAIN ENTRY POINT
# --------------------------------------------------------------------------
def run(uiapp, data, log):
    """Exports selected Revit sheets to DWG or DXF and writes response.json."""
    try:
        doc = uiapp.ActiveUIDocument.Document

        # Extract parameters
        sheet_ids = data.get("sheet_ids", [])
        cad_format = data.get("cad_format", "dwg").lower()
        export_path = data.get("path", r"C:\PADApps\RevitPAD\ExportsDWG")

        if not os.path.exists(export_path):
            os.makedirs(export_path)

        log("Starting export_sheets_to_cad -> {}".format(export_path))
        log("Format: {} | Sheets: {}".format(cad_format, len(sheet_ids)))

        # Choose export options
        if cad_format == "dxf":
            options = DXFExportOptions()
        else:
            options = DWGExportOptions()

        # Options cleanup & safety
        try: options.ExportViewsAsExternalReferences = False
        except: pass
        try: options.MergedViews = True
        except: pass
        try: options.SharedCoords = False
        except: pass
        try: options.ExportingAreas = False
        except: pass

        # Collect sheets
        all_sheets = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Sheets)

        if not sheet_ids:
            export_sheets = all_sheets
        else:
            export_sheets = [s for s in all_sheets if s.Id.IntegerValue in sheet_ids]

        if not export_sheets:
            msg = "No matching sheets found for DWG export."
            log(msg)
            write_response({"error": msg}, log)
            return

        exported = []

        # ----------------------------------------------------------------------
        # EXPORT LOOP
        # ----------------------------------------------------------------------
        for sheet in export_sheets:
            try:
                sheetnum = sheet.SheetNumber
                sheetname = sheet.Name

                # Safe filename
                combined = "{}_{}".format(sheetnum, sheetname)
                safe_name = "".join([c for c in combined if c.isalnum() or c in ("_", "-")])

                views = List[ElementId]([sheet.Id])
                result = doc.Export(export_path, safe_name, views, options)

                if result:
                    file_path = os.path.join(export_path, safe_name + "." + cad_format)
                    exported.append(file_path)
                    log("Exported: {}".format(file_path))

            except Exception as e:
                log("Failed to export sheet {}: {}".format(sheet.SheetNumber, e))

        # ----------------------------------------------------------------------
        # WRITE SUCCESS RESPONSE
        # ----------------------------------------------------------------------
        payload = {
            "status": "ok",
            "exported_count": len(exported),
            "exported_files": exported
        }

        write_response(payload, log)
        log("DWG Export complete: {} files".format(len(exported)))

    except Exception as e:
        err = "DWG Export error: {}".format(e)
        log(err)
        write_response({"error": err}, log)

################################################################################
### RevitPAD\Core\commands\export_sheets_to_pdf.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json
from pyrevit import forms
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    BuiltInCategory,
    PrintRange
)

PDF_DRIVER = "PDFCreator"

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def write_response(payload, log):
    """Write ONLY error responses from Revit."""
    try:
        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)
        with open(RESPONSE_PATH, "w") as f:
            json.dump(payload, f, indent=2)
        log("Response.json written.")
    except Exception as e:
        log("ERROR writing response.json: {}".format(e))


def run(uiapp, data, log):
    """
    Export sheets to PDF.
    NOTE:
        • NO success response is written.
        • BlueTree will detect, move, and write the final response.
    """
    try:
        uidoc = uiapp.ActiveUIDocument
        doc = uidoc.Document

        # ---------------------------------------------------
        # Incoming request data
        # ---------------------------------------------------
        sheet_ids = data.get("sheet_ids", [])
        export_path = data.get("path", r"C:\PADApps\RevitPAD\ExportsPDF")

        if not os.path.exists(export_path):
            os.makedirs(export_path)

        if not sheet_ids:
            msg = "No sheet_ids passed to export_sheets_to_pdf"
            log(msg)
            write_response({"error": msg}, log)
            return

        log("PRINT-CURRENT-WINDOW mode started")
        log("Sheet IDs received: {}".format(sheet_ids))

        # ---------------------------------------------------
        # Collect matching sheets
        # ---------------------------------------------------
        collector = (
            FilteredElementCollector(doc)
            .OfCategory(BuiltInCategory.OST_Sheets)
            .WhereElementIsNotElementType()
        )

        sheets = [s for s in collector if s.Id.IntegerValue in sheet_ids]

        if not sheets:
            msg = "No valid sheets found for provided IDs."
            log(msg)
            write_response({"error": msg}, log)
            return

        # ---------------------------------------------------
        # Configure PDF print driver
        # ---------------------------------------------------
        pm = doc.PrintManager
        pm.SelectNewPrintDriver(PDF_DRIVER)
        pm.PrintToFile = True
        pm.PrintRange = PrintRange.Current

        # ---------------------------------------------------
        # Loop — one sheet per file
        # (PDFCreator overrides the filename)
        # ---------------------------------------------------
        for sheet in sheets:
            log("→ Activating sheet {}".format(sheet.SheetNumber))

            uidoc.ActiveView = sheet

            num = sheet.SheetNumber
            name = sheet.Name
            combined = "{}_{}".format(num, name)
            safe = "".join([c for c in combined if c.isalnum() or c in ("_", "-")])

            out_file = os.path.join(export_path, safe + ".pdf")
            log("→ Printing to: {}".format(out_file))

            pm.PrintToFileName = out_file
            pm.Apply()
            pm.SubmitPrint()

            log("✔ Printed (PDFCreator may rename): {}".format(out_file))

        # ---------------------------------------------------
        # IMPORTANT:
        # NO SUCCESS RESPONSE WRITTEN HERE.
        # BlueTree detects and moves the files,
        # then generates the REAL response with correct paths.
        # ---------------------------------------------------

    except Exception as e:
        err = "PDF Export error: {}".format(e)
        log(err)
        write_response({"error": err}, log)

################################################################################
### RevitPAD\Core\commands\export_views_to_nwc.py
################################################################################
# -*- coding: utf-8 -*-
import os, json, clr
from pyrevit import forms
from Autodesk.Revit.DB import View
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    BuiltInCategory,
    ElementId,
    NavisworksExportOptions,
    NavisworksExportScope,
    NavisworksCoordinates
)

# Add System.Collections.Generic for List[ElementId]
clr.AddReference("System")
from System.Collections.Generic import List

# --------------------------------------------------------------------------
# RESPONSE PATH
# --------------------------------------------------------------------------
REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def write_response(payload, log):
    """Write response.json for NWC export (success or error)."""
    try:
        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)
        with open(RESPONSE_PATH, "w") as f:
            json.dump(payload, f, indent=2)
        log("NWC response.json written.")
    except Exception as e:
        log("ERROR writing NWC response.json: {}".format(e))


# --------------------------------------------------------------------------
# MAIN ENTRY POINT
# --------------------------------------------------------------------------
def run(uiapp, data, log):
    """Exports selected Revit views to NWC and writes response.json."""
    try:
        doc = uiapp.ActiveUIDocument.Document

        # Extract parameters
        view_ids = data.get("view_ids", [])
        export_path = data.get("path", r"C:\PADApps\RevitPAD\ExportsNWC")

        if not os.path.exists(export_path):
            os.makedirs(export_path)

        log("Starting export_views_to_nwc -> {}".format(export_path))
        log("Views: {}".format(len(view_ids)))

        # Collect all views
        all_views = FilteredElementCollector(doc).OfClass(View)


        if not view_ids:
            export_views = all_views
        else:
            export_views = [v for v in all_views if v.Id.IntegerValue in view_ids]

        if not export_views:
            msg = "No matching views found for NWC export."
            log(msg)
            write_response({"error": msg}, log)
            return

        exported = []

        # ----------------------------------------------------------------------
        # EXPORT LOOP
        # ----------------------------------------------------------------------
        for view in export_views:
            try:
                viewname = view.Name
                viewnum = view.Id.IntegerValue

                # Safe filename
                combined = "{}_{}".format(viewnum, viewname)
                safe_name = "".join([c for c in combined if c.isalnum() or c in ("_", "-")])

                # Options
                options = NavisworksExportOptions()
                options.ExportScope = NavisworksExportScope.View
                options.ViewId = view.Id
                options.Coordinates = NavisworksCoordinates.Shared

                try:
                    options.ExportLinks = True
                except:
                    pass

                # Export → always add .nwc suffix
                result = doc.Export(export_path, safe_name, options)

                file_path = os.path.join(export_path, safe_name + ".nwc")

                # Navisworks exporter often returns False even on success, so check file existence
                if os.path.exists(file_path):
                    exported.append(file_path)
                    log("Exported: {}".format(file_path))
                else:
                    log("⚠️ Export reported failure (return=False) but file not found.")

            except Exception as e:
                log("Failed to export view {}: {}".format(view.Id.IntegerValue, e))

        # ----------------------------------------------------------------------
        # WRITE SUCCESS RESPONSE
        # ----------------------------------------------------------------------
        payload = {
            "status": "ok",
            "exported_count": len(exported),
            "exported_files": exported
        }

        write_response(payload, log)
        log("NWC Export complete: {} files".format(len(exported)))

    except Exception as e:
        err = "NWC Export error: {}".format(e)
        log(err)
        write_response({"error": err}, log)

################################################################################
### RevitPAD\Core\commands\open_view_by_id.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json
from Autodesk.Revit.DB import ElementId

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def run(uiapp, data, log):
    """
    Opens a view in Revit by its element ID.
    """
    try:
        doc = uiapp.ActiveUIDocument.Document
        view_id_int = data.get("id")

        if not view_id_int:
            raise Exception("Missing 'id' field for open-view-by-id")

        # Correct creation of ElementId
        eid = ElementId(view_id_int)
        view_elem = doc.GetElement(eid)

        if not view_elem:
            raise Exception("No view found with id {0}".format(view_id_int))

        # Switch active view
        uiapp.ActiveUIDocument.ActiveView = view_elem

        result = {
            "status": "ok",
            "opened_view_id": view_id_int,
            "opened_view_name": view_elem.Name
        }

        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        with open(RESPONSE_PATH, "w") as f:
            json.dump(result, f, indent=2)

        log("Opened view id {0}: {1}".format(view_id_int, view_elem.Name))

    except Exception as e:
        with open(RESPONSE_PATH, "w") as f:
            json.dump({"error": str(e)}, f, indent=2)
        log("Error in open_view_by_id: {0}".format(e))

################################################################################
### RevitPAD\Core\commands\test_command.py
################################################################################

from Autodesk.Revit.UI import TaskDialog

def run(uiapp, data, log):
    try:
        log("Running TEST COMMAND")
        TaskDialog.Show("Test Command", "Test command executed successfully.")  
        log("Test command completed.")
    except Exception as e:
        log("Test command error: {0}".format(e))

################################################################################
### RevitPAD\Core\CommandWatcherHelper.py
################################################################################
# -*- coding: utf-8 -*-
import os
import sys
import time
import threading
import json
import importlib
from pyrevit import forms
from Autodesk.Revit.UI import IExternalEventHandler

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
BRIDGE_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Bridge")
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
LOG_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Logs")

class CommandWatcherHandler(IExternalEventHandler):
    """Revit command dispatcher that dynamically loads command modules."""

    def __init__(self, watch_path):
        self.uiapp_cached = None 
        self.event_pending = False
        self.watch_path = watch_path
        self.last_mod_time = None
        self.last_command = None


        self.keep_running = True
        base_dir = os.path.dirname(watch_path)
        self.commands_dir = os.path.join(os.path.dirname(__file__), "commands")
        self.requests_dir = os.path.join(os.path.dirname(__file__), "requests")




        self.log_path = os.path.join(LOG_FOLDER, "revit_pad_log.txt")

        # Ensure commands directory is in import path
        if self.commands_dir not in sys.path:
            sys.path.append(self.commands_dir)

    def log(self, msg):
        try:
            ts = time.strftime("%Y-%m-%d %H:%M:%S")
            with open(self.log_path, "ab") as f:
                f.write(u"[{0}] {1}\n".format(ts, msg).encode("utf-8", "replace"))
        except Exception:
            pass

    def Execute(self, uiapp):

        try:
            if not os.path.exists(self.watch_path):
                return
            
            if os.path.getsize(self.watch_path) < 5:
                return
                
            if self.uiapp_cached is None:
                self.uiapp_cached = uiapp
                self.log("Cached UIApplication")

            mod_time = os.path.getmtime(self.watch_path)
            if mod_time == self.last_mod_time:
                return
            self.last_mod_time = mod_time

            # --- wait for writer to finish ---
            for _ in range(10):
                if os.path.getsize(self.watch_path) > 5:
                    break
                time.sleep(0.05)

            

            with open(self.watch_path, "r") as f:
                data = json.load(f)

            cmd = (data.get("command") or data.get("request") or "").strip()
            if not cmd or cmd == self.last_command:
                return

            self.last_command = cmd
            self.log("Command received: {0}".format(cmd))
            self.run_command(cmd, uiapp, data)

        except Exception as e:
            self.log("Error in Execute: {0}".format(e))

        finally:
            self.event_pending = False


    def run_command(self, cmd, uiapp, data):
        

        try:
            if cmd == "stop_watcher":
                self.log("Received stop_watcher command. Stopping loop.")

                # Remove the lock file
                try:
                    os.remove(os.path.join(BRIDGE_FOLDER, "watcher.lock"))
                    self.log("Watcher lock file removed.")
                except:
                    pass

                # Clear the command file to prevent reprocessing
                try:
                    with open(self.watch_path, "w") as f:
                        f.write("{}")
                    self.log("stop_watcher cleared from JSON file.")
                except:
                    self.log("Failed to clear stop_watcher from JSON file.")

                # Reset last command so nothing lingers
                self.last_command = None

                # Stop the loop
                self.keep_running = False
                return


            module_name = cmd.replace("-", "_")

            if "request" in data:
                module_path = self.requests_dir
            else:
                module_path = self.commands_dir

            sys.path.append(module_path)

            self.log("IMPORTING: {0}".format(module_name))
            module = importlib.import_module(module_name)

            self.log("LOADED FROM: {0}".format(getattr(module, "__file__", "UNKNOWN")))

            # IronPython reload (Python 2 syntax)
            try:
                reload(module)
            except Exception as e:
                self.log("Reload warning: {0}".format(e))

            if hasattr(module, "run"):
                data["watch_path"] = self.watch_path
                module.run(uiapp, data, self.log)

                # NEW: clear file to stop repeats
                try:
                    with open(self.watch_path, "w") as f:
                        f.write("{}")
                    self.log("Command cleared from JSON file.")
                except:
                    self.log("Failed to clear command file.")

                self.last_command = None

        except Exception as e:
            self.log("⚠ Command failed ({0}): {1}".format(cmd, e))
            forms.alert("⚠ Command failed:\n{0}\n\n{1}".format(cmd, e),
                        title="Command Watcher")


    def GetName(self):
        return "Command Watcher Event"

    def start(self, ext_event, interval=3):

        def loop():
            time.sleep(5)
            self.log("Command Watcher active.")

            while True:
                if not self.keep_running:
                    self.log("Watcher loop exiting cleanly.")
                    return  # <-- EXIT THREAD IMMEDIATELY

                # HEARTBEAT
                try:
                    heartbeat_path = os.path.join(BRIDGE_FOLDER, "revit_heartbeat.json")
                    with open(heartbeat_path, "w") as hb:
                        hb.write(json.dumps({"timestamp": time.time(), "status": "alive"}))
                except:
                    pass

                # Raise events
                if not self.event_pending:
                    self.event_pending = True
                    try:
                        ext_event.Raise()
                    except:
                        self.event_pending = False

                # Short sleep for responsive shutdown
                for _ in range(30):   # 30 × 0.1s = 3 seconds total
                    if not self.keep_running:
                        self.log("Watcher loop stopping during sleep.")
                        return
                    time.sleep(0.1)


        t = threading.Thread(target=loop)
        t.daemon = True
        t.start()

################################################################################
### RevitPAD\Core\requests\get_3d_views.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    View3D
)

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def run(uiapp, data, log):
    """
    Returns all 3D views in the current Revit document.
    Includes id, name, view type, and perspective flag.
    """
    try:
        doc = uiapp.ActiveUIDocument.Document

        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        views = []
        collector = FilteredElementCollector(doc).OfClass(View3D)

        for v in collector:
            try:
                # Skip templates
                if v.IsTemplate:
                    continue

                views.append({
                    "id": v.Id.IntegerValue,
                    "name": v.Name,
                    "is_perspective": bool(v.IsPerspective),
                    "view_type": str(v.ViewType)
                })
            except Exception:
                pass

        result = {"views": views}

        with open(RESPONSE_PATH, "w") as f:
            json.dump(result, f, indent=2)

        log("Returned 3D views: {0}".format(len(views)))

    except Exception as e:
        with open(RESPONSE_PATH, "w") as f:
            json.dump({"error": str(e)}, f, indent=2)
        log("Error in get_3d_views: {0}".format(e))

################################################################################
### RevitPAD\Core\requests\get_active_view.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def run(uiapp, data, log):
    """
    Returns information about the current active view in Revit.
    """
    try:
        doc = uiapp.ActiveUIDocument.Document
        view = doc.ActiveView

        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        result = {
            "view_name": view.Name,
            "view_id": view.Id.IntegerValue,
            "view_type": str(view.ViewType)
        }

        with open(RESPONSE_PATH, "w") as f:
            json.dump(result, f, indent=2)

        log("Returned active view information: {0}".format(view.Name))

    except Exception as e:
        # Return error in response.json
        with open(RESPONSE_PATH, "w") as f:
            json.dump({"error": str(e)}, f, indent=2)
        log("Error in get_active_view: {0}".format(e))

################################################################################
### RevitPAD\Core\requests\get_all_views.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    View
)

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def run(uiapp, data, log):
    """
    Returns ALL non-template views in the model.
    Grouped by general view type.
    """
    try:
        doc = uiapp.ActiveUIDocument.Document

        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        # Prepare container for grouping
        views_by_type = {}

        collector = FilteredElementCollector(doc).OfClass(View)

        for v in collector:
            try:
                if v.IsTemplate:
                    continue

                vtype = str(v.ViewType)

                if vtype not in views_by_type:
                    views_by_type[vtype] = []

                views_by_type[vtype].append({
                    "id": v.Id.IntegerValue,
                    "name": v.Name,
                    "view_type": vtype
                })

            except Exception:
                pass

        result = {"views": views_by_type}

        with open(RESPONSE_PATH, "w") as f:
            json.dump(result, f, indent=2)

        log("Returned all views grouped by type.")

    except Exception as e:
        # Return error
        with open(RESPONSE_PATH, "w") as f:
            json.dump({"error": str(e)}, f, indent=2)

        log("Error in get_all_views: {0}".format(e))

################################################################################
### RevitPAD\Core\requests\get_model_path.py
################################################################################
# -*- coding: utf-8 -*-
import os, json
from Autodesk.Revit.DB import ModelPathUtils

DATA_FOLDER = r"C:\PADApps\RevitPAD\Data"
RESPONSE = os.path.join(DATA_FOLDER, "response.json")

def run(uiapp, data, log):
    try:
        doc = uiapp.ActiveUIDocument.Document

        # Get absolute model path
        model_path = doc.PathName

        # Detect parent folder
        parent = os.path.dirname(model_path) if model_path else ""

        result = {
            "model_path": model_path,
            "parent_folder": parent,
        }

        # Persist response
        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        with open(RESPONSE, "w") as f:
            json.dump(result, f, indent=2)

        log("Returned model path → {0}".format(model_path))

    except Exception as e:
        log("Error in get_model_path: {0}".format(e))

################################################################################
### RevitPAD\Core\requests\get_sheet_data.py
################################################################################
# -*- coding: utf-8 -*-
import os
import json
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    BuiltInCategory,
    BuiltInParameter,
    Revision
)

REVIT_PAD_FOLDER = r"C:\PADApps\RevitPAD"
DATA_FOLDER = os.path.join(REVIT_PAD_FOLDER, "Data")
RESPONSE_PATH = os.path.join(DATA_FOLDER, "response.json")


def run(uiapp, data, log):
    """
    Request handler: returns all Revit sheets and revision metadata.
    Writes output to response.json for BlueTree to read.
    """
    try:
        doc = uiapp.ActiveUIDocument.Document

        if not os.path.exists(DATA_FOLDER):
            os.makedirs(DATA_FOLDER)

        sheets_out = []

        collector = FilteredElementCollector(doc).OfCategory(
            BuiltInCategory.OST_Sheets
        )

        for s in collector:
            try:
                # --- Current revision number ---
                rev_param = s.get_Parameter(BuiltInParameter.SHEET_CURRENT_REVISION)
                current_rev_num = rev_param.AsString() if rev_param else None
                if not current_rev_num:
                    current_rev_num = None

                rev_desc = None
                rev_date = None

                # --- Match the Revision element ---
                if current_rev_num:
                    for rev_id in s.GetAllRevisionIds():
                        rev = doc.GetElement(rev_id)
                        if isinstance(rev, Revision) and rev.RevisionNumber == current_rev_num:
                            rev_desc = rev.Description
                            rev_date = rev.RevisionDate
                            break

                sheets_out.append({
                    "id": s.Id.IntegerValue,
                    "sheet_number": s.SheetNumber,
                    "sheet_name": s.Name,
                    "revision_number": current_rev_num,
                    "revision_description": rev_desc,
                    "revision_date": rev_date
                })

            except Exception:
                pass

        # --- Write request result ---
        result = {"sheets": sheets_out}

        with open(RESPONSE_PATH, "w") as f:
            json.dump(result, f, indent=2)

        log("Returned sheet data: {0} sheets".format(len(sheets_out)))

    except Exception as e:
        log("Error in get_sheet_data: {0}".format(e))

################################################################################
### RevitPAD\Data\current_tool.json
################################################################################
{
    "current_tool": "DRAWINGS"
}

################################################################################
### RevitPAD\Data\current_tool_config.json
################################################################################
{
    "current_config": "All"
}

################################################################################
### RevitPAD\Data\data.json
################################################################################
{}

################################################################################
### RevitPAD\Data\response.json
################################################################################
{}

################################################################################
### RevitPAD\Data\tool_configs\All.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "Revit Pad Tool configuration"
  },
  "tools": [
    "DESIGNER",
    "LIGHT_TABLE",
    "CLEAN_UP",
    "DRAWINGS",
    "INVERTS",
    "LEVELS",
    "PENOS",
    "SETTINGS"
  ]
}

################################################################################
### RevitPAD\Data\tool_configs\Design.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "Revit Pad Tool configuration"
  },
  "tools": [
    "DESIGNER",
    "LIGHT_TABLE",
    "INVERTS",
    "LEVELS",
    "SETTINGS"
  ]
}

################################################################################
### RevitPAD\Data\tool_configs\Set Up.json
################################################################################
{
  "meta": {
    "version": "1.1",
    "description": "Revit Pad Tool configuration"
  },
  "tools": [
    "LIGHT_TABLE",
    "CLEAN_UP",
    "DRAWINGS",
    "SETTINGS"
  ]
}

################################################################################
### RevitPAD\folder_structure.txt
################################################################################
    ___folder_snapshot.py.py
    folder_structure.txt
    Bridge/
        revit_command.json
        revit_heartbeat.json
        watcher.lock
    commands/
        commands.json
        send_export_sheets_to_cad.py
        send_export_sheets_to_json.py
        send_start_watching.py
        send_stop_watching.py
        send_test_command.py
    Core/
        CommandWatcherHelper.py
        ___snapshot.py
        __init__.py
        commands/
            __init__.py
            export_sheets_to_cad.py
            export_sheets_to_pdf.py
            export_views_to_nwc.py
            open_view_by_id.py
            test_command.py
        requests/
            __init__.py
            get_3d_views.py
            get_active_view.py
            get_all_views.py
            get_model_path.py
            get_sheet_data.py
        _code/
            Command Watcher.pushbutton_code.txt
    Data/
        current_tool.json
        current_tool_config.json
        data.json
        response.json
        tool_configs/
            All.json
            Design.json
            Set Up.json
            __init__.py
    Exports/
    ExportsPDF/
    Logs/
        revit_pad_log.txt
    ThinkPad.extension/
        ThinkPad.tab/
            __init__.py
            Automation.panel/
                Command Watcher.pushbutton/
                    CommandWatcherHelper.py
                    ___snapshot.py
                    script.py
                    commands/
                        __init__.py
                        export_sheets_to_cad.py
                        export_sheets_to_json.py
                    _code/
                        Command Watcher.pushbutton_code.txt
                Export Navisworks.pushbutton/
                    script.py
                Save Export Settings.pushbutton/
                    script.py
                Test/
                    __init__.py
                    Test.pushbutton/
                        script.py

################################################################################
### RevitPAD\Logs\revit_pad_log.txt
################################################################################
[2025-11-29 12:05:05] Command received: get-sheet-data
[2025-11-29 12:05:05] IMPORTING: get_sheet_data
[2025-11-29 12:05:05] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 12:05:05] Returned sheet data: 27 sheets
[2025-11-29 12:05:05] Command cleared from JSON file.
[2025-11-29 12:05:12] Command received: get-model-path
[2025-11-29 12:05:12] IMPORTING: get_model_path
[2025-11-29 12:05:12] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:05:12] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:05:12] Command cleared from JSON file.
[2025-11-29 12:05:15] Command received: export_sheets_to_cad
[2025-11-29 12:05:15] IMPORTING: export_sheets_to_cad
[2025-11-29 12:05:15] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_sheets_to_cad.py
[2025-11-29 12:05:15] Starting export_sheets_to_cad -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG
[2025-11-29 12:05:15] Format: dwg | Sheets: 2
[2025-11-29 12:05:36] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG\P300_SECTIONSSANITARYRISERS.dwg
[2025-11-29 12:05:58] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG\P301_SECTIONSSANITARYRISERS.dwg
[2025-11-29 12:05:58] DWG response.json written.
[2025-11-29 12:05:58] DWG Export complete: 2 files
[2025-11-29 12:05:58] Command cleared from JSON file.
[2025-11-29 12:07:48] Command received: get-sheet-data
[2025-11-29 12:07:48] IMPORTING: get_sheet_data
[2025-11-29 12:07:48] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 12:07:48] Returned sheet data: 27 sheets
[2025-11-29 12:07:48] Command cleared from JSON file.
[2025-11-29 12:07:55] Command received: get-model-path
[2025-11-29 12:07:55] IMPORTING: get_model_path
[2025-11-29 12:07:55] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:07:55] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:07:55] Command cleared from JSON file.
[2025-11-29 12:07:58] Command received: export_sheets_to_cad
[2025-11-29 12:07:58] IMPORTING: export_sheets_to_cad
[2025-11-29 12:07:58] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_sheets_to_cad.py
[2025-11-29 12:07:58] Starting export_sheets_to_cad -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG
[2025-11-29 12:07:58] Format: dwg | Sheets: 2
[2025-11-29 12:08:17] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG\P300_SECTIONSSANITARYRISERS.dwg
[2025-11-29 12:08:38] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\DWG\P301_SECTIONSSANITARYRISERS.dwg
[2025-11-29 12:08:38] DWG response.json written.
[2025-11-29 12:08:38] DWG Export complete: 2 files
[2025-11-29 12:08:38] Command cleared from JSON file.
[2025-11-29 12:09:29] Command received: get-3d-views
[2025-11-29 12:09:29] IMPORTING: get_3d_views
[2025-11-29 12:09:29] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:09:29] Returned 3D views: 5
[2025-11-29 12:09:29] Command cleared from JSON file.
[2025-11-29 12:09:39] Command received: get-model-path
[2025-11-29 12:09:39] IMPORTING: get_model_path
[2025-11-29 12:09:39] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:09:39] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:09:39] Command cleared from JSON file.
[2025-11-29 12:09:42] Command received: export_views_to_nwc
[2025-11-29 12:09:42] IMPORTING: export_views_to_nwc
[2025-11-29 12:09:42] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:09:42] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\NWC
[2025-11-29 12:09:42] Views: 1
[2025-11-29 12:11:57] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\NWC\1400366_3DWaterManifold.nwc
[2025-11-29 12:11:57] NWC response.json written.
[2025-11-29 12:11:57] NWC Export complete: 1 files
[2025-11-29 12:11:57] Command cleared from JSON file.
[2025-11-29 12:12:59] Command received: get-3d-views
[2025-11-29 12:12:59] IMPORTING: get_3d_views
[2025-11-29 12:12:59] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:13:00] Returned 3D views: 5
[2025-11-29 12:13:00] Command cleared from JSON file.
[2025-11-29 12:13:03] Command received: get-model-path
[2025-11-29 12:13:03] IMPORTING: get_model_path
[2025-11-29 12:13:03] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:13:03] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:13:03] Command cleared from JSON file.
[2025-11-29 12:15:02] Command received: get-3d-views
[2025-11-29 12:15:02] IMPORTING: get_3d_views
[2025-11-29 12:15:02] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:15:02] Returned 3D views: 5
[2025-11-29 12:15:02] Command cleared from JSON file.
[2025-11-29 12:15:09] Command received: get-model-path
[2025-11-29 12:15:09] IMPORTING: get_model_path
[2025-11-29 12:15:09] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:15:09] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:15:09] Command cleared from JSON file.
[2025-11-29 12:15:12] Command received: export_views_to_nwc
[2025-11-29 12:15:12] IMPORTING: export_views_to_nwc
[2025-11-29 12:15:12] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:15:12] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\NWC
[2025-11-29 12:15:12] Views: 1
[2025-11-29 12:15:43] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing\NWC\1400366_3DWaterManifold.nwc
[2025-11-29 12:15:43] NWC response.json written.
[2025-11-29 12:15:43] NWC Export complete: 1 files
[2025-11-29 12:15:43] Command cleared from JSON file.
[2025-11-29 12:16:38] Command received: get-3d-views
[2025-11-29 12:16:38] IMPORTING: get_3d_views
[2025-11-29 12:16:38] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:16:38] Returned 3D views: 36
[2025-11-29 12:16:38] Command cleared from JSON file.
[2025-11-29 12:16:47] Command received: get-model-path
[2025-11-29 12:16:47] IMPORTING: get_model_path
[2025-11-29 12:16:47] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:16:47] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural.rvt
[2025-11-29 12:16:47] Command cleared from JSON file.
[2025-11-29 12:16:50] Command received: export_views_to_nwc
[2025-11-29 12:16:50] IMPORTING: export_views_to_nwc
[2025-11-29 12:16:50] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:16:50] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC
[2025-11-29 12:16:50] Views: 1
[2025-11-29 12:16:55] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC\789453_Cutaway-Stair2.nwc
[2025-11-29 12:16:55] NWC response.json written.
[2025-11-29 12:16:55] NWC Export complete: 1 files
[2025-11-29 12:16:55] Command cleared from JSON file.
[2025-11-29 12:18:03] Command received: get-3d-views
[2025-11-29 12:18:03] IMPORTING: get_3d_views
[2025-11-29 12:18:03] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:18:03] Returned 3D views: 36
[2025-11-29 12:18:03] Command cleared from JSON file.
[2025-11-29 12:18:15] Command received: get-model-path
[2025-11-29 12:18:15] IMPORTING: get_model_path
[2025-11-29 12:18:15] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:18:15] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural.rvt
[2025-11-29 12:18:15] Command cleared from JSON file.
[2025-11-29 12:18:18] Command received: export_views_to_nwc
[2025-11-29 12:18:18] IMPORTING: export_views_to_nwc
[2025-11-29 12:18:18] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:18:18] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC
[2025-11-29 12:18:18] Views: 1
[2025-11-29 12:18:19] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC\2141690_WV_3DBeamWraps.nwc
[2025-11-29 12:18:19] NWC response.json written.
[2025-11-29 12:18:19] NWC Export complete: 1 files
[2025-11-29 12:18:19] Command cleared from JSON file.
[2025-11-29 12:18:51] Command received: get-3d-views
[2025-11-29 12:18:51] IMPORTING: get_3d_views
[2025-11-29 12:18:51] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:18:51] Returned 3D views: 36
[2025-11-29 12:18:51] Command cleared from JSON file.
[2025-11-29 12:19:51] Command received: get-model-path
[2025-11-29 12:19:51] IMPORTING: get_model_path
[2025-11-29 12:19:51] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:19:51] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural.rvt
[2025-11-29 12:19:51] Command cleared from JSON file.
[2025-11-29 12:19:54] Command received: export_views_to_nwc
[2025-11-29 12:19:54] IMPORTING: export_views_to_nwc
[2025-11-29 12:19:54] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:19:54] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC
[2025-11-29 12:19:54] Views: 1
[2025-11-29 12:20:13] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC\2304727_WalkthroughLobbyStair.nwc
[2025-11-29 12:20:13] NWC response.json written.
[2025-11-29 12:20:13] NWC Export complete: 1 files
[2025-11-29 12:20:13] Command cleared from JSON file.
[2025-11-29 12:20:56] Command received: get-3d-views
[2025-11-29 12:20:56] IMPORTING: get_3d_views
[2025-11-29 12:20:56] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-11-29 12:20:56] Returned 3D views: 36
[2025-11-29 12:20:56] Command cleared from JSON file.
[2025-11-29 12:21:23] Command received: get-model-path
[2025-11-29 12:21:23] IMPORTING: get_model_path
[2025-11-29 12:21:23] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:21:23] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural.rvt
[2025-11-29 12:21:23] Command cleared from JSON file.
[2025-11-29 12:21:26] Command received: export_views_to_nwc
[2025-11-29 12:21:26] IMPORTING: export_views_to_nwc
[2025-11-29 12:21:26] LOADED FROM: C:\PADApps\RevitPAD\Core\commands\export_views_to_nwc.py
[2025-11-29 12:21:26] Starting export_views_to_nwc -> C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC
[2025-11-29 12:21:26] Views: 1
[2025-11-29 12:21:29] Exported: C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Architectural\NWC\2265711_Coord-ArchResidentialCores.nwc
[2025-11-29 12:21:29] NWC response.json written.
[2025-11-29 12:21:29] NWC Export complete: 1 files
[2025-11-29 12:21:29] Command cleared from JSON file.
[2025-11-29 12:28:04] Command received: get-sheet-data
[2025-11-29 12:28:04] IMPORTING: get_sheet_data
[2025-11-29 12:28:04] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 12:28:04] Returned sheet data: 27 sheets
[2025-11-29 12:28:04] Command cleared from JSON file.
[2025-11-29 12:30:28] Command received: get-sheet-data
[2025-11-29 12:30:28] IMPORTING: get_sheet_data
[2025-11-29 12:30:28] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 12:30:28] Returned sheet data: 27 sheets
[2025-11-29 12:30:28] Command cleared from JSON file.
[2025-11-29 12:30:31] Command received: get-model-path
[2025-11-29 12:30:31] IMPORTING: get_model_path
[2025-11-29 12:30:31] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 12:30:31] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-11-29 12:30:31] Command cleared from JSON file.
[2025-11-29 23:36:11] Command Watcher active.
[2025-11-29 23:36:11] Cached UIApplication
[2025-11-29 23:36:11] Command received: get-sheet-data
[2025-11-29 23:36:11] IMPORTING: get_sheet_data
[2025-11-29 23:36:11] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 23:36:11] Returned sheet data: 0 sheets
[2025-11-29 23:36:11] Command cleared from JSON file.
[2025-11-29 23:36:14] Command received: get-sheet-data
[2025-11-29 23:36:14] IMPORTING: get_sheet_data
[2025-11-29 23:36:14] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 23:36:14] Returned sheet data: 0 sheets
[2025-11-29 23:36:14] Command cleared from JSON file.
[2025-11-29 23:36:32] Command received: get-model-path
[2025-11-29 23:36:32] IMPORTING: get_model_path
[2025-11-29 23:36:32] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 23:36:32] Returned model path → C:\Users\nweck\Dropbox\HydrauliCAD-BT\Demo\Products\Revit - CAD Details\halgantradewaste\MGTS1000 - 5000\HALGAN MGTS 3000L Grease Trap.rfa
[2025-11-29 23:36:32] Command cleared from JSON file.
[2025-11-29 23:36:35] Command received: get-model-path
[2025-11-29 23:36:35] IMPORTING: get_model_path
[2025-11-29 23:36:35] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 23:36:35] Returned model path → C:\Users\nweck\Dropbox\HydrauliCAD-BT\Demo\Products\Revit - CAD Details\halgantradewaste\MGTS1000 - 5000\HALGAN MGTS 3000L Grease Trap.rfa
[2025-11-29 23:36:35] Command cleared from JSON file.
[2025-11-29 23:36:38] Command received: get-model-path
[2025-11-29 23:36:38] IMPORTING: get_model_path
[2025-11-29 23:36:38] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-11-29 23:36:38] Returned model path → C:\Users\nweck\Dropbox\HydrauliCAD-BT\Demo\Products\Revit - CAD Details\halgantradewaste\MGTS1000 - 5000\HALGAN MGTS 3000L Grease Trap.rfa
[2025-11-29 23:36:38] Command cleared from JSON file.
[2025-11-29 23:36:54] Command received: get-sheet-data
[2025-11-29 23:36:54] IMPORTING: get_sheet_data
[2025-11-29 23:36:54] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-11-29 23:36:54] Returned sheet data: 0 sheets
[2025-11-29 23:36:54] Command cleared from JSON file.
[2025-11-30 22:25:07] Command Watcher active.
[2025-11-30 22:25:09] Cached UIApplication
[2025-11-30 22:25:09] Command received: stop_watcher
[2025-11-30 22:25:09] Received stop_watcher command. Stopping loop.
[2025-11-30 22:25:09] Watcher lock file removed.
[2025-11-30 22:25:09] stop_watcher cleared from JSON file.
[2025-11-30 22:25:09] Watcher loop stopping during sleep.
[2025-12-02 23:44:37] Command Watcher active.
[2025-12-02 23:44:37] Cached UIApplication
[2025-12-02 23:44:37] Command received: get-sheet-data
[2025-12-02 23:44:37] IMPORTING: get_sheet_data
[2025-12-02 23:44:37] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-12-02 23:44:37] Returned sheet data: 27 sheets
[2025-12-02 23:44:37] Command cleared from JSON file.
[2025-12-02 23:44:46] Command received: get-3d-views
[2025-12-02 23:44:46] IMPORTING: get_3d_views
[2025-12-02 23:44:46] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_3d_views.py
[2025-12-02 23:44:46] Returned 3D views: 5
[2025-12-02 23:44:46] Command cleared from JSON file.
[2025-12-02 23:44:52] Command received: get-sheet-data
[2025-12-02 23:44:52] IMPORTING: get_sheet_data
[2025-12-02 23:44:52] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-12-02 23:44:52] Returned sheet data: 27 sheets
[2025-12-02 23:44:52] Command cleared from JSON file.
[2025-12-02 23:44:55] Command received: get-model-path
[2025-12-02 23:44:55] IMPORTING: get_model_path
[2025-12-02 23:44:55] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_model_path.py
[2025-12-02 23:44:55] Returned model path → C:\Users\nweck\Dropbox\BlueTree\Demo\Projects\2501 - Snowdon Towers\2. Project Inputs\2.2 Revit\Snowdon Towers Sample Plumbing.rvt
[2025-12-02 23:44:55] Command cleared from JSON file.
[2025-12-02 23:45:01] Command received: get-sheet-data
[2025-12-02 23:45:01] IMPORTING: get_sheet_data
[2025-12-02 23:45:01] LOADED FROM: C:\PADApps\RevitPAD\Core\requests\get_sheet_data.py
[2025-12-02 23:45:01] Returned sheet data: 27 sheets
[2025-12-02 23:45:01] Command cleared from JSON file.

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\commands\export_sheets_to_cad.py
################################################################################
# -*- coding: utf-8 -*-
import os, json, clr
from pyrevit import forms
from Autodesk.Revit.DB import (
    FilteredElementCollector,
    BuiltInCategory,
    ViewSheet,
    DWGExportOptions,
    DXFExportOptions,
    ElementId
)

# Import List for proper ICollection conversion
clr.AddReference("System")
from System.Collections.Generic import List


def run(uiapp, data, log):
    """Exports selected Revit sheets to DWG or DXF."""
    try:
        doc = uiapp.ActiveUIDocument.Document

        # Extract parameters
        sheet_ids = data.get("sheet_ids", [])
        cad_format = data.get("cad_format", "dwg").lower()
        export_path = data.get("path", r"C:\PADApps\RevitPAD\Exports")

        if not os.path.exists(export_path):
            os.makedirs(export_path)

        log("Starting export_sheets_to_cad -> {0}".format(export_path))
        log("Format: {0} | Sheets: {1}".format(cad_format, len(sheet_ids)))

        # Choose export options
        if cad_format == "dxf":
            options = DXFExportOptions()
        else:
            options = DWGExportOptions()


        # Prevent Xrefs and separate files
        try: 
            options.ExportViewsAsExternalReferences = False
        except: 
            pass

        # Merge all sheet views into a single DWG
        try:
            options.MergedViews = True
        except:
            pass

        # Prevent coordinates/export splitting
        try:
            options.SharedCoords = False
        except:
            pass

        # Prevent Revit from exporting parts of sheets separately
        try:
            options.ExportingAreas = False
        except:
            pass

        # Collect target sheets
        all_sheets = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Sheets)
        # If sheet_ids is empty, export everything
        if not sheet_ids:
            export_sheets = all_sheets
        else:
            export_sheets = [s for s in all_sheets if s.Id.IntegerValue in sheet_ids]

        if not export_sheets:
            msg = "⚠️ No matching sheets found for export."
            log(msg)
            forms.alert(msg, title="Revit Command Watcher")
            return

        # Export loop
        exported = []
        for sheet in export_sheets:
            try:
                sheetnum = sheet.SheetNumber
                sheetname = sheet.Name

                # Build safe filename (no f-strings allowed)
                combined = "{0}_{1}".format(sheetnum, sheetname)
                safe_name = "".join([c for c in combined if c.isalnum() or c in ("_", "-")])

                views = List[ElementId]([sheet.Id])  # ICollection[ElementId]
                result = doc.Export(export_path, safe_name, views, options)

                if result:
                    file_path = os.path.join(export_path, safe_name + "." + cad_format)
                    exported.append(file_path)
                    log("Exported: {0}".format(file_path))

            except Exception as e:
                log("Failed to export sheet {0}: {1}".format(sheet.SheetNumber, e))

        msg = "Export complete: {0} files exported to\n{1}".format(len(exported), export_path)
        log(msg)
        forms.alert(msg, title="Revit Command Watcher")

    except Exception as e:
        log("Error in export_sheets_to_cad: {0}".format(e))

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\commands\export_sheets_to_json.py
################################################################################
# -*- coding: utf-8 -*-
import os, json
from pyrevit import forms
from Autodesk.Revit.DB import FilteredElementCollector, BuiltInCategory


def run(uiapp, data, log):
    """Exports all Revit sheets to JSON file."""
    try:
        doc = uiapp.ActiveUIDocument.Document
        base_dir = os.path.dirname(data.get("watch_path", r"C:\PADApps\RevitPAD\Bridge"))
        output_path = os.path.join(base_dir, "revit_sheets.json")

        sheets = []
        for s in FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Sheets):
            try:
                sheets.append({
                    "id": s.Id.IntegerValue,
                    "sheet_number": s.SheetNumber,
                    "sheet_name": s.Name
                })
            except Exception:
                pass

        with open(output_path, "wb") as f:
            txt = json.dumps({"sheets": sheets}, indent=2, ensure_ascii=False)
            f.write(txt.encode("utf-8"))

        msg = "✅ Exported {0} sheets → {1}".format(len(sheets), output_path)
        log(msg)
        forms.alert(msg, title="Revit Command Watcher")

    except Exception as e:
        log("Error in export_sheets_to_json: {0}".format(e))

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\CommandWatcherHelper.py
################################################################################
# -*- coding: utf-8 -*-
import os
import sys
import time
import threading
import json
import importlib
from pyrevit import forms
from Autodesk.Revit.UI import IExternalEventHandler


class CommandWatcherHandler(IExternalEventHandler):
    """Revit command dispatcher that dynamically loads command modules."""

    def __init__(self, watch_path):
        self.watch_path = watch_path
        self.last_mod_time = None
        self.last_command = None
        self.keep_running = True
        base_dir = os.path.dirname(watch_path)
        self.commands_dir = os.path.join(os.path.dirname(__file__), "commands")
        self.log_path = os.path.join(base_dir, "revit_command_log.txt")

        # Ensure commands directory is in import path
        if self.commands_dir not in sys.path:
            sys.path.append(self.commands_dir)

    def log(self, msg):
        try:
            ts = time.strftime("%Y-%m-%d %H:%M:%S")
            with open(self.log_path, "ab") as f:
                f.write(u"[{0}] {1}\n".format(ts, msg).encode("utf-8", "replace"))
        except Exception:
            pass

    def Execute(self, uiapp):
        try:
            if not os.path.exists(self.watch_path):
                return

            mod_time = os.path.getmtime(self.watch_path)
            if mod_time == self.last_mod_time:
                return
            self.last_mod_time = mod_time

            # --- wait for writer to finish ---
            for _ in range(10):
                if os.path.getsize(self.watch_path) > 5:
                    break
                time.sleep(0.05)

            if os.path.getsize(self.watch_path) < 5:
                self.log("⚠️ JSON file empty, skipping")
                return

            with open(self.watch_path, "r") as f:
                data = json.load(f)

            cmd = data.get("command", "").strip()
            if not cmd or cmd == self.last_command:
                return

            self.last_command = cmd
            self.log("Command received: {0}".format(cmd))
            self.run_command(cmd, uiapp, data)

        except Exception as e:
            self.log("Error in Execute: {0}".format(e))


    def run_command(self, cmd, uiapp, data):
        try:
            module_name = cmd.replace("-", "_")

            self.log("IMPORTING: {0}".format(module_name))
            module = importlib.import_module(module_name)

            self.log("LOADED FROM: {0}".format(getattr(module, "__file__", "UNKNOWN")))

            # IronPython reload (Python 2 syntax)
            try:
                reload(module)
            except Exception as e:
                self.log("Reload warning: {0}".format(e))

            if hasattr(module, "run"):
                data["watch_path"] = self.watch_path
                module.run(uiapp, data, self.log)
                self.log("✓ Command executed successfully: {0}".format(cmd))
            else:
                self.log("⚠ No 'run' function in: {0}".format(module_name))

        except Exception as e:
            self.log("⚠ Command failed ({0}): {1}".format(cmd, e))
            forms.alert("⚠ Command failed:\n{0}\n\n{1}".format(cmd, e),
                        title="Command Watcher")


    def GetName(self):
        return "Command Watcher Event"

    def start(self, ext_event, interval=3):
        def loop():
            time.sleep(5)
            self.log("Command Watcher active.")
            while self.keep_running:
                time.sleep(interval)
                try:
                    ext_event.Raise()
                except:
                    break
            self.log("Command Watcher stopped.")

        t = threading.Thread(target=loop)
        t.setDaemon(True)
        t.start()

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Command Watcher.pushbutton\script.py
################################################################################
# -*- coding: utf-8 -*-
import os
from pyrevit import forms
from Autodesk.Revit.UI import ExternalEvent

from CommandWatcherHelper import CommandWatcherHandler


__title__ = "👀 Command Watcher"
__doc__ = "Background watcher for file modifications using ExternalEvent."

WATCH_PATH = r"C:\PADApps\RevitPAD\Bridge\revit_command.json"


def main():
    if not os.path.exists(WATCH_PATH):
        folder = os.path.dirname(WATCH_PATH)
        if not os.path.exists(folder):
            os.makedirs(folder)
        open(WATCH_PATH, "w").close()

    handler = CommandWatcherHandler(WATCH_PATH)
    ext_event = ExternalEvent.Create(handler)

    handler.start(ext_event)

    forms.alert(
        "👀 Command Watcher started.\n\n"
        "Watching for file edits at:\n\n{0}\n\n"
        "Logs will be written to:\n{1}\n\n"
        "Close Revit to stop the watcher.".format(
            WATCH_PATH, handler.log_path
        ),
        title="Command Watcher",
    )


if __name__ == "__main__":
    main()

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Export Navisworks.pushbutton\script.py
################################################################################
# -*- coding: utf-8 -*-
from pyrevit import forms, revit, DB
import os, json

__title__ = "📤 Navisworks Export"
__doc__ = "Exports the current active view (with linked files) to Navisworks using global export settings."

def get_global_config_path():
    base_dir = os.path.join(os.environ["APPDATA"], "ThinkPad_Global")
    return os.path.join(base_dir, "navisworks_export_config.json")

def read_config():
    conf_path = get_global_config_path()
    if os.path.exists(conf_path):
        with open(conf_path, "r") as f:
            return json.load(f)
    return {}

def main():
    try:
        # 🔧 Load global export config
        config = read_config()
        export_dir = config.get("export_path", "").replace("\\", "/")
        export_name = config.get("name", "").strip()

        if not export_dir:
            forms.alert("⚠️ Export folder not set.\nPlease run 'Save Export Settings' first.", title="Navisworks Export")
            return

        if not os.path.exists(export_dir):
            os.makedirs(export_dir)

        doc = revit.doc
        view = doc.ActiveView
        view_name = view.Name

        if not export_name:
            export_name = view_name.replace(":", "_").replace("\\", "_").replace("/", "_")

        safe_name = export_name.replace(":", "_").replace("\\", "_").replace("/", "_")
        export_path = os.path.join(export_dir, safe_name + ".nwc")

        # ⚙️ Navisworks export options
        options = DB.NavisworksExportOptions()
        options.ExportScope = DB.NavisworksExportScope.View
        options.ViewId = view.Id
        options.Coordinates = DB.NavisworksCoordinates.Shared

        try:
            options.ExportLinks = True
        except:
            pass

        # 🚀 Export current view
        doc.Export(export_dir, safe_name + ".nwc", options)

        forms.alert(
            "✅ Exported current view to Navisworks!\n\nView: {0}\nFile: {1}".format(view_name, export_path),
            title="Navisworks Export"
        )

    except Exception as e:
        forms.alert("❌ Export failed:\n{0}".format(e), title="Navisworks Export")

if __name__ == "__main__":
    main()

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Save Export Settings.pushbutton\script.py
################################################################################
# -*- coding: utf-8 -*-
from pyrevit import forms
import os, json

__title__ = "💾 Export Settings"
__doc__ = "Reads and saves Navisworks export settings to a global JSON file."

def get_global_config_path():
    base_dir = os.path.join(os.environ["APPDATA"], "ThinkPad_Global")
    if not os.path.exists(base_dir):
        os.makedirs(base_dir)
    return os.path.join(base_dir, "navisworks_export_config.json")

def read_config():
    conf_path = get_global_config_path()
    if os.path.exists(conf_path):
        with open(conf_path, "r") as f:
            return json.load(f)
    return {}

def write_config(data):
    conf_path = get_global_config_path()
    with open(conf_path, "w") as f:
        json.dump(data, f, indent=4)
    return conf_path

def main():
    # Load current settings
    config = read_config()
    current_name = config.get("name", "")
    current_export_path = config.get("export_path", "")

    # Ask for export name
    name = forms.ask_for_string(
        default=current_name, prompt="Enter export name:", title="Navisworks Export Config"
    )
    if not name:
        return

    # Ask for folder
    export_path = forms.pick_folder(title="Select Export Folder")
    if not export_path:
        return

    # Save config
    new_config = {
        "name": name,
        "export_path": export_path.replace("\\", "/")
    }
    conf_path = write_config(new_config)

    msg = (
        "✅ Export settings saved!\n\n"
        "📄 Name: {0}\n"
        "📁 Path: {1}\n\n"
        "Config stored at:\n{2}"
    ).format(name, export_path, conf_path)

    forms.alert(msg, title="Global Export Config")

if __name__ == "__main__":
    main()

################################################################################
### RevitPAD\ThinkPad.extension\ThinkPad.tab\Automation.panel\Test\Test.pushbutton\script.py
################################################################################
# -*- coding: utf-8 -*-
from pyrevit import forms, revit, DB
import os, json

__title__ = "Test"
__doc__ = "Test"

def main():

        forms.alert(
            u"✅ Test completed successfully!",
            title=u"ThinkPad → Test"
        )


if __name__ == "__main__":
    main()
